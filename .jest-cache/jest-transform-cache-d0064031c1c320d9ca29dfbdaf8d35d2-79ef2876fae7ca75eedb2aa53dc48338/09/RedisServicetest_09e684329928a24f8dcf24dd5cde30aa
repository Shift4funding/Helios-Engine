5f1314b0005cfc44a7ac300b99744b7f
"use strict";

// Mock Redis client
_getJestObj().mock('ioredis', () => {
  return jest.fn().mockImplementation(() => ({
    ping: jest.fn().mockResolvedValue('PONG'),
    set: jest.fn().mockResolvedValue('OK'),
    get: jest.fn().mockImplementation(key => {
      return Promise.resolve(JSON.stringify({
        data: 'test-value'
      }));
    }),
    quit: jest.fn().mockResolvedValue('OK'),
    on: jest.fn()
  }));
});
function _getJestObj() {
  const {
    jest
  } = require("@jest/globals");
  _getJestObj = () => jest;
  return jest;
}
require('dotenv').config();
const RedisService = require('../../src/services/RedisService');
describe('RedisService', () => {
  beforeAll(async () => {
    await RedisService.connect();
  });
  afterAll(async () => {
    await RedisService.disconnect();
  });
  it('should set and get a value', async () => {
    const key = 'test-key';
    const value = {
      data: 'test-value'
    };
    await RedisService.set(key, value);
    const result = await RedisService.get(key);
    expect(result).toEqual(value);
  });
  it('should handle connection errors', async () => {
    const originalClient = RedisService.client;
    RedisService.client = null;
    await expect(RedisService.set('key', 'value')).rejects.toThrow('Redis not connected');
    RedisService.client = originalClient;
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2V0SmVzdE9iaiIsIm1vY2siLCJqZXN0IiwiZm4iLCJtb2NrSW1wbGVtZW50YXRpb24iLCJwaW5nIiwibW9ja1Jlc29sdmVkVmFsdWUiLCJzZXQiLCJnZXQiLCJrZXkiLCJQcm9taXNlIiwicmVzb2x2ZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJkYXRhIiwicXVpdCIsIm9uIiwicmVxdWlyZSIsImNvbmZpZyIsIlJlZGlzU2VydmljZSIsImRlc2NyaWJlIiwiYmVmb3JlQWxsIiwiY29ubmVjdCIsImFmdGVyQWxsIiwiZGlzY29ubmVjdCIsIml0IiwidmFsdWUiLCJyZXN1bHQiLCJleHBlY3QiLCJ0b0VxdWFsIiwib3JpZ2luYWxDbGllbnQiLCJjbGllbnQiLCJyZWplY3RzIiwidG9UaHJvdyJdLCJzb3VyY2VzIjpbIlJlZGlzU2VydmljZS50ZXN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbInJlcXVpcmUoJ2RvdGVudicpLmNvbmZpZygpO1xyXG5jb25zdCBSZWRpc1NlcnZpY2UgPSByZXF1aXJlKCcuLi8uLi9zcmMvc2VydmljZXMvUmVkaXNTZXJ2aWNlJyk7XHJcblxyXG4vLyBNb2NrIFJlZGlzIGNsaWVudFxyXG5qZXN0Lm1vY2soJ2lvcmVkaXMnLCAoKSA9PiB7XHJcbiAgICByZXR1cm4gamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiAoe1xyXG4gICAgICAgIHBpbmc6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSgnUE9ORycpLFxyXG4gICAgICAgIHNldDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKCdPSycpLFxyXG4gICAgICAgIGdldDogamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoa2V5KSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoSlNPTi5zdHJpbmdpZnkoeyBkYXRhOiAndGVzdC12YWx1ZScgfSkpO1xyXG4gICAgICAgIH0pLFxyXG4gICAgICAgIHF1aXQ6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSgnT0snKSxcclxuICAgICAgICBvbjogamVzdC5mbigpXHJcbiAgICB9KSk7XHJcbn0pO1xyXG5cclxuZGVzY3JpYmUoJ1JlZGlzU2VydmljZScsICgpID0+IHtcclxuICAgIGJlZm9yZUFsbChhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgYXdhaXQgUmVkaXNTZXJ2aWNlLmNvbm5lY3QoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGFmdGVyQWxsKGFzeW5jICgpID0+IHtcclxuICAgICAgICBhd2FpdCBSZWRpc1NlcnZpY2UuZGlzY29ubmVjdCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBzZXQgYW5kIGdldCBhIHZhbHVlJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGtleSA9ICd0ZXN0LWtleSc7XHJcbiAgICAgICAgY29uc3QgdmFsdWUgPSB7IGRhdGE6ICd0ZXN0LXZhbHVlJyB9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIGF3YWl0IFJlZGlzU2VydmljZS5zZXQoa2V5LCB2YWx1ZSk7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgUmVkaXNTZXJ2aWNlLmdldChrZXkpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwodmFsdWUpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY29ubmVjdGlvbiBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgY29uc3Qgb3JpZ2luYWxDbGllbnQgPSBSZWRpc1NlcnZpY2UuY2xpZW50O1xyXG4gICAgICAgIFJlZGlzU2VydmljZS5jbGllbnQgPSBudWxsO1xyXG5cclxuICAgICAgICBhd2FpdCBleHBlY3QoUmVkaXNTZXJ2aWNlLnNldCgna2V5JywgJ3ZhbHVlJykpXHJcbiAgICAgICAgICAgIC5yZWplY3RzXHJcbiAgICAgICAgICAgIC50b1Rocm93KCdSZWRpcyBub3QgY29ubmVjdGVkJyk7XHJcblxyXG4gICAgICAgIFJlZGlzU2VydmljZS5jbGllbnQgPSBvcmlnaW5hbENsaWVudDtcclxuICAgIH0pO1xyXG59KTsiXSwibWFwcGluZ3MiOiI7O0FBR0E7QUFDQUEsV0FBQSxHQUFLQyxJQUFJLENBQUMsU0FBUyxFQUFFLE1BQU07RUFDdkIsT0FBT0MsSUFBSSxDQUFDQyxFQUFFLENBQUMsQ0FBQyxDQUFDQyxrQkFBa0IsQ0FBQyxPQUFPO0lBQ3ZDQyxJQUFJLEVBQUVILElBQUksQ0FBQ0MsRUFBRSxDQUFDLENBQUMsQ0FBQ0csaUJBQWlCLENBQUMsTUFBTSxDQUFDO0lBQ3pDQyxHQUFHLEVBQUVMLElBQUksQ0FBQ0MsRUFBRSxDQUFDLENBQUMsQ0FBQ0csaUJBQWlCLENBQUMsSUFBSSxDQUFDO0lBQ3RDRSxHQUFHLEVBQUVOLElBQUksQ0FBQ0MsRUFBRSxDQUFDLENBQUMsQ0FBQ0Msa0JBQWtCLENBQUVLLEdBQUcsSUFBSztNQUN2QyxPQUFPQyxPQUFPLENBQUNDLE9BQU8sQ0FBQ0MsSUFBSSxDQUFDQyxTQUFTLENBQUM7UUFBRUMsSUFBSSxFQUFFO01BQWEsQ0FBQyxDQUFDLENBQUM7SUFDbEUsQ0FBQyxDQUFDO0lBQ0ZDLElBQUksRUFBRWIsSUFBSSxDQUFDQyxFQUFFLENBQUMsQ0FBQyxDQUFDRyxpQkFBaUIsQ0FBQyxJQUFJLENBQUM7SUFDdkNVLEVBQUUsRUFBRWQsSUFBSSxDQUFDQyxFQUFFLENBQUM7RUFDaEIsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUM7QUFBQyxTQUFBSCxZQUFBO0VBQUE7SUFBQUU7RUFBQSxJQUFBZSxPQUFBO0VBQUFqQixXQUFBLEdBQUFBLENBQUEsS0FBQUUsSUFBQTtFQUFBLE9BQUFBLElBQUE7QUFBQTtBQWRIZSxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUNDLE1BQU0sQ0FBQyxDQUFDO0FBQzFCLE1BQU1DLFlBQVksR0FBR0YsT0FBTyxDQUFDLGlDQUFpQyxDQUFDO0FBZS9ERyxRQUFRLENBQUMsY0FBYyxFQUFFLE1BQU07RUFDM0JDLFNBQVMsQ0FBQyxZQUFZO0lBQ2xCLE1BQU1GLFlBQVksQ0FBQ0csT0FBTyxDQUFDLENBQUM7RUFDaEMsQ0FBQyxDQUFDO0VBRUZDLFFBQVEsQ0FBQyxZQUFZO0lBQ2pCLE1BQU1KLFlBQVksQ0FBQ0ssVUFBVSxDQUFDLENBQUM7RUFDbkMsQ0FBQyxDQUFDO0VBRUZDLEVBQUUsQ0FBQyw0QkFBNEIsRUFBRSxZQUFZO0lBQ3pDLE1BQU1oQixHQUFHLEdBQUcsVUFBVTtJQUN0QixNQUFNaUIsS0FBSyxHQUFHO01BQUVaLElBQUksRUFBRTtJQUFhLENBQUM7SUFFcEMsTUFBTUssWUFBWSxDQUFDWixHQUFHLENBQUNFLEdBQUcsRUFBRWlCLEtBQUssQ0FBQztJQUNsQyxNQUFNQyxNQUFNLEdBQUcsTUFBTVIsWUFBWSxDQUFDWCxHQUFHLENBQUNDLEdBQUcsQ0FBQztJQUUxQ21CLE1BQU0sQ0FBQ0QsTUFBTSxDQUFDLENBQUNFLE9BQU8sQ0FBQ0gsS0FBSyxDQUFDO0VBQ2pDLENBQUMsQ0FBQztFQUVGRCxFQUFFLENBQUMsaUNBQWlDLEVBQUUsWUFBWTtJQUM5QyxNQUFNSyxjQUFjLEdBQUdYLFlBQVksQ0FBQ1ksTUFBTTtJQUMxQ1osWUFBWSxDQUFDWSxNQUFNLEdBQUcsSUFBSTtJQUUxQixNQUFNSCxNQUFNLENBQUNULFlBQVksQ0FBQ1osR0FBRyxDQUFDLEtBQUssRUFBRSxPQUFPLENBQUMsQ0FBQyxDQUN6Q3lCLE9BQU8sQ0FDUEMsT0FBTyxDQUFDLHFCQUFxQixDQUFDO0lBRW5DZCxZQUFZLENBQUNZLE1BQU0sR0FBR0QsY0FBYztFQUN4QyxDQUFDLENBQUM7QUFDTixDQUFDLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=