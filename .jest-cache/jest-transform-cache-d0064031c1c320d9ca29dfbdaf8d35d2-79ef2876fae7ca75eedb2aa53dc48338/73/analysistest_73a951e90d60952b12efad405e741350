4e2142ec6c5af1312c03431f24b4de4e
"use strict";

require('dotenv').config({
  path: '.env.test'
});
const request = require('supertest');
const path = require('path');
const app = require('../testApp');
describe('Analysis API Integration', () => {
  const TEST_PDF_PATH = path.join(__dirname, '../fixtures/sample-statement.pdf');
  beforeAll(() => {
    // Create test PDF if it doesn't exist
    require('fs').writeFileSync(TEST_PDF_PATH, Buffer.from('Mock PDF content'));
  });
  describe('Basic API Tests', () => {
    it('should return 200 on health check', async () => {
      const response = await request(app).get('/health');
      expect(response.status).toBe(200);
      expect(response.body).toHaveProperty('status', 'ok');
    });
  });
  describe('POST /api/analysis/statement', () => {
    it('should analyze bank statement', async () => {
      const response = await request(app).post('/api/analysis/statement').attach('bankStatement', TEST_PDF_PATH);
      expect(response.status).toBe(200);
      expect(response.body).toHaveProperty('success', true);
      expect(response.body.data).toHaveProperty('summary');
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyZXF1aXJlIiwiY29uZmlnIiwicGF0aCIsInJlcXVlc3QiLCJhcHAiLCJkZXNjcmliZSIsIlRFU1RfUERGX1BBVEgiLCJqb2luIiwiX19kaXJuYW1lIiwiYmVmb3JlQWxsIiwid3JpdGVGaWxlU3luYyIsIkJ1ZmZlciIsImZyb20iLCJpdCIsInJlc3BvbnNlIiwiZ2V0IiwiZXhwZWN0Iiwic3RhdHVzIiwidG9CZSIsImJvZHkiLCJ0b0hhdmVQcm9wZXJ0eSIsInBvc3QiLCJhdHRhY2giLCJkYXRhIl0sInNvdXJjZXMiOlsiYW5hbHlzaXMudGVzdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKCdkb3RlbnYnKS5jb25maWcoeyBwYXRoOiAnLmVudi50ZXN0JyB9KTtcclxuY29uc3QgcmVxdWVzdCA9IHJlcXVpcmUoJ3N1cGVydGVzdCcpO1xyXG5jb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xyXG5jb25zdCBhcHAgPSByZXF1aXJlKCcuLi90ZXN0QXBwJyk7XHJcblxyXG5kZXNjcmliZSgnQW5hbHlzaXMgQVBJIEludGVncmF0aW9uJywgKCkgPT4ge1xyXG4gICAgY29uc3QgVEVTVF9QREZfUEFUSCA9IHBhdGguam9pbihfX2Rpcm5hbWUsICcuLi9maXh0dXJlcy9zYW1wbGUtc3RhdGVtZW50LnBkZicpO1xyXG4gICAgXHJcbiAgICBiZWZvcmVBbGwoKCkgPT4ge1xyXG4gICAgICAgIC8vIENyZWF0ZSB0ZXN0IFBERiBpZiBpdCBkb2Vzbid0IGV4aXN0XHJcbiAgICAgICAgcmVxdWlyZSgnZnMnKS53cml0ZUZpbGVTeW5jKFxyXG4gICAgICAgICAgICBURVNUX1BERl9QQVRILFxyXG4gICAgICAgICAgICBCdWZmZXIuZnJvbSgnTW9jayBQREYgY29udGVudCcpXHJcbiAgICAgICAgKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdCYXNpYyBBUEkgVGVzdHMnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gMjAwIG9uIGhlYWx0aCBjaGVjaycsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcCkuZ2V0KCcvaGVhbHRoJyk7XHJcbiAgICAgICAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcclxuICAgICAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdzdGF0dXMnLCAnb2snKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdQT1NUIC9hcGkvYW5hbHlzaXMvc3RhdGVtZW50JywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdzaG91bGQgYW5hbHl6ZSBiYW5rIHN0YXRlbWVudCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcclxuICAgICAgICAgICAgICAgIC5wb3N0KCcvYXBpL2FuYWx5c2lzL3N0YXRlbWVudCcpXHJcbiAgICAgICAgICAgICAgICAuYXR0YWNoKCdiYW5rU3RhdGVtZW50JywgVEVTVF9QREZfUEFUSCk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XHJcbiAgICAgICAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgnc3VjY2VzcycsIHRydWUpO1xyXG4gICAgICAgICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5kYXRhKS50b0hhdmVQcm9wZXJ0eSgnc3VtbWFyeScpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn0pOyJdLCJtYXBwaW5ncyI6Ijs7QUFBQUEsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDQyxNQUFNLENBQUM7RUFBRUMsSUFBSSxFQUFFO0FBQVksQ0FBQyxDQUFDO0FBQy9DLE1BQU1DLE9BQU8sR0FBR0gsT0FBTyxDQUFDLFdBQVcsQ0FBQztBQUNwQyxNQUFNRSxJQUFJLEdBQUdGLE9BQU8sQ0FBQyxNQUFNLENBQUM7QUFDNUIsTUFBTUksR0FBRyxHQUFHSixPQUFPLENBQUMsWUFBWSxDQUFDO0FBRWpDSyxRQUFRLENBQUMsMEJBQTBCLEVBQUUsTUFBTTtFQUN2QyxNQUFNQyxhQUFhLEdBQUdKLElBQUksQ0FBQ0ssSUFBSSxDQUFDQyxTQUFTLEVBQUUsa0NBQWtDLENBQUM7RUFFOUVDLFNBQVMsQ0FBQyxNQUFNO0lBQ1o7SUFDQVQsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDVSxhQUFhLENBQ3ZCSixhQUFhLEVBQ2JLLE1BQU0sQ0FBQ0MsSUFBSSxDQUFDLGtCQUFrQixDQUNsQyxDQUFDO0VBQ0wsQ0FBQyxDQUFDO0VBRUZQLFFBQVEsQ0FBQyxpQkFBaUIsRUFBRSxNQUFNO0lBQzlCUSxFQUFFLENBQUMsbUNBQW1DLEVBQUUsWUFBWTtNQUNoRCxNQUFNQyxRQUFRLEdBQUcsTUFBTVgsT0FBTyxDQUFDQyxHQUFHLENBQUMsQ0FBQ1csR0FBRyxDQUFDLFNBQVMsQ0FBQztNQUNsREMsTUFBTSxDQUFDRixRQUFRLENBQUNHLE1BQU0sQ0FBQyxDQUFDQyxJQUFJLENBQUMsR0FBRyxDQUFDO01BQ2pDRixNQUFNLENBQUNGLFFBQVEsQ0FBQ0ssSUFBSSxDQUFDLENBQUNDLGNBQWMsQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDO0lBQ3hELENBQUMsQ0FBQztFQUNOLENBQUMsQ0FBQztFQUVGZixRQUFRLENBQUMsOEJBQThCLEVBQUUsTUFBTTtJQUMzQ1EsRUFBRSxDQUFDLCtCQUErQixFQUFFLFlBQVk7TUFDNUMsTUFBTUMsUUFBUSxHQUFHLE1BQU1YLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLENBQzlCaUIsSUFBSSxDQUFDLHlCQUF5QixDQUFDLENBQy9CQyxNQUFNLENBQUMsZUFBZSxFQUFFaEIsYUFBYSxDQUFDO01BRTNDVSxNQUFNLENBQUNGLFFBQVEsQ0FBQ0csTUFBTSxDQUFDLENBQUNDLElBQUksQ0FBQyxHQUFHLENBQUM7TUFDakNGLE1BQU0sQ0FBQ0YsUUFBUSxDQUFDSyxJQUFJLENBQUMsQ0FBQ0MsY0FBYyxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUM7TUFDckRKLE1BQU0sQ0FBQ0YsUUFBUSxDQUFDSyxJQUFJLENBQUNJLElBQUksQ0FBQyxDQUFDSCxjQUFjLENBQUMsU0FBUyxDQUFDO0lBQ3hELENBQUMsQ0FBQztFQUNOLENBQUMsQ0FBQztBQUNOLENBQUMsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==