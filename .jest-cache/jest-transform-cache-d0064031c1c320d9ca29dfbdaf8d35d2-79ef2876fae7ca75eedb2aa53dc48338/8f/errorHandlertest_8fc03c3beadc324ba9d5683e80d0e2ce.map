{"version":3,"names":["_getJestObj","mock","jest","require","errorHandler","AppError","logger","describe","mockReq","mockRes","mockNext","beforeEach","path","method","id","status","fn","mockReturnThis","json","error","mockClear","it","expect","toHaveBeenCalledWith","message","toHaveBeenCalled","process","env","NODE_ENV","Error"],"sources":["errorHandler.test.js"],"sourcesContent":["const errorHandler = require('../../src/middleware/errorHandler');\r\nconst { AppError } = require('../../src/utils/errors');\r\nconst logger = require('../../src/config/logger');\r\n\r\njest.mock('../../src/config/logger');\r\n\r\ndescribe('Error Handler Middleware', () => {\r\n    let mockReq;\r\n    let mockRes;\r\n    let mockNext;\r\n\r\n    beforeEach(() => {\r\n        mockReq = {\r\n            path: '/test',\r\n            method: 'GET',\r\n            id: 'test-id'\r\n        };\r\n        mockRes = {\r\n            status: jest.fn().mockReturnThis(),\r\n            json: jest.fn()\r\n        };\r\n        mockNext = jest.fn();\r\n        logger.error.mockClear();\r\n    });\r\n\r\n    it('should handle operational errors', () => {\r\n        const error = new AppError('Test error', 400);\r\n        \r\n        errorHandler(error, mockReq, mockRes, mockNext);\r\n        \r\n        expect(mockRes.status).toHaveBeenCalledWith(400);\r\n        expect(mockRes.json).toHaveBeenCalledWith({\r\n            status: 'fail',\r\n            message: 'Test error'\r\n        });\r\n        expect(logger.error).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should hide error details in production', () => {\r\n        process.env.NODE_ENV = 'production';\r\n        const error = new Error('System error');\r\n        \r\n        errorHandler(error, mockReq, mockRes, mockNext);\r\n        \r\n        expect(mockRes.status).toHaveBeenCalledWith(500);\r\n        expect(mockRes.json).toHaveBeenCalledWith({\r\n            status: 'error',\r\n            message: 'Something went wrong'\r\n        });\r\n    });\r\n});"],"mappings":";;AAIAA,WAAA,GAAKC,IAAI,CAAC,yBAAyB,CAAC;AAAC,SAAAD,YAAA;EAAA;IAAAE;EAAA,IAAAC,OAAA;EAAAH,WAAA,GAAAA,CAAA,KAAAE,IAAA;EAAA,OAAAA,IAAA;AAAA;AAJrC,MAAME,YAAY,GAAGD,OAAO,CAAC,mCAAmC,CAAC;AACjE,MAAM;EAAEE;AAAS,CAAC,GAAGF,OAAO,CAAC,wBAAwB,CAAC;AACtD,MAAMG,MAAM,GAAGH,OAAO,CAAC,yBAAyB,CAAC;AAIjDI,QAAQ,CAAC,0BAA0B,EAAE,MAAM;EACvC,IAAIC,OAAO;EACX,IAAIC,OAAO;EACX,IAAIC,QAAQ;EAEZC,UAAU,CAAC,MAAM;IACbH,OAAO,GAAG;MACNI,IAAI,EAAE,OAAO;MACbC,MAAM,EAAE,KAAK;MACbC,EAAE,EAAE;IACR,CAAC;IACDL,OAAO,GAAG;MACNM,MAAM,EAAEb,IAAI,CAACc,EAAE,CAAC,CAAC,CAACC,cAAc,CAAC,CAAC;MAClCC,IAAI,EAAEhB,IAAI,CAACc,EAAE,CAAC;IAClB,CAAC;IACDN,QAAQ,GAAGR,IAAI,CAACc,EAAE,CAAC,CAAC;IACpBV,MAAM,CAACa,KAAK,CAACC,SAAS,CAAC,CAAC;EAC5B,CAAC,CAAC;EAEFC,EAAE,CAAC,kCAAkC,EAAE,MAAM;IACzC,MAAMF,KAAK,GAAG,IAAId,QAAQ,CAAC,YAAY,EAAE,GAAG,CAAC;IAE7CD,YAAY,CAACe,KAAK,EAAEX,OAAO,EAAEC,OAAO,EAAEC,QAAQ,CAAC;IAE/CY,MAAM,CAACb,OAAO,CAACM,MAAM,CAAC,CAACQ,oBAAoB,CAAC,GAAG,CAAC;IAChDD,MAAM,CAACb,OAAO,CAACS,IAAI,CAAC,CAACK,oBAAoB,CAAC;MACtCR,MAAM,EAAE,MAAM;MACdS,OAAO,EAAE;IACb,CAAC,CAAC;IACFF,MAAM,CAAChB,MAAM,CAACa,KAAK,CAAC,CAACM,gBAAgB,CAAC,CAAC;EAC3C,CAAC,CAAC;EAEFJ,EAAE,CAAC,yCAAyC,EAAE,MAAM;IAChDK,OAAO,CAACC,GAAG,CAACC,QAAQ,GAAG,YAAY;IACnC,MAAMT,KAAK,GAAG,IAAIU,KAAK,CAAC,cAAc,CAAC;IAEvCzB,YAAY,CAACe,KAAK,EAAEX,OAAO,EAAEC,OAAO,EAAEC,QAAQ,CAAC;IAE/CY,MAAM,CAACb,OAAO,CAACM,MAAM,CAAC,CAACQ,oBAAoB,CAAC,GAAG,CAAC;IAChDD,MAAM,CAACb,OAAO,CAACS,IAAI,CAAC,CAACK,oBAAoB,CAAC;MACtCR,MAAM,EAAE,OAAO;MACfS,OAAO,EAAE;IACb,CAAC,CAAC;EACN,CAAC,CAAC;AACN,CAAC,CAAC","ignoreList":[]}