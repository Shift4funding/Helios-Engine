{"version":3,"names":["_getJestObj","mock","__esModule","default","jest","fn","require","PDFParseError","pdfParserService","fs","promises","path","describe","mockPdfData","beforeEach","mockReset","it","mockResolvedValue","text","buffer","Buffer","from","result","parsePDF","expect","toMatchObject","accountInfo","accountHolder","accountNumber","statementPeriod","start","end","transactions","date","description","debit","credit","mockRejectedValue","Error","rejects","toThrow","toHaveLength","toEqual"],"sources":["pdfParserService.test.js"],"sourcesContent":["const { PDFParseError } = require('../../src/utils/errors');\r\nconst pdfParserService = require('../../src/services/pdfParserService');\r\nconst fs = require('fs').promises;\r\nconst path = require('path');\r\n\r\njest.mock('pdf-parse', () => ({\r\n    __esModule: true,\r\n    default: jest.fn()\r\n}));\r\n\r\ndescribe('PDF Parser Service', () => {\r\n    const mockPdfData = `\r\n        Statement Period: 05/01/2025 to 05/31/2025\r\n        Account Holder: John Doe\r\n        Account Number: ****1234\r\n        \r\n        Transaction History:\r\n        05/15/2025 GROCERY STORE -$50.00\r\n        05/16/2025 SALARY DEPOSIT +$2000.00\r\n    `;\r\n\r\n    beforeEach(() => {\r\n        require('pdf-parse').default.mockReset();\r\n    });\r\n\r\n    it('should successfully parse PDF content', async () => {\r\n        require('pdf-parse').default.mockResolvedValue({\r\n            text: mockPdfData\r\n        });\r\n\r\n        const buffer = Buffer.from('mock pdf content');\r\n        const result = await pdfParserService.parsePDF(buffer);\r\n\r\n        expect(result).toMatchObject({\r\n            accountInfo: {\r\n                accountHolder: 'John Doe',\r\n                accountNumber: '****1234',\r\n                statementPeriod: {\r\n                    start: '05/01/2025',\r\n                    end: '05/31/2025'\r\n                }\r\n            },\r\n            transactions: [\r\n                {\r\n                    date: '05/15/2025',\r\n                    description: 'GROCERY STORE',\r\n                    debit: 50.00,\r\n                    credit: null\r\n                },\r\n                {\r\n                    date: '05/16/2025',\r\n                    description: 'SALARY DEPOSIT',\r\n                    debit: null,\r\n                    credit: 2000.00\r\n                }\r\n            ]\r\n        });\r\n    });\r\n\r\n    it('should handle invalid PDF content', async () => {\r\n        require('pdf-parse').default.mockRejectedValue(\r\n            new Error('Failed to parse PDF')\r\n        );\r\n\r\n        const buffer = Buffer.from('invalid pdf');\r\n        await expect(pdfParserService.parsePDF(buffer))\r\n            .rejects\r\n            .toThrow(PDFParseError);\r\n    });\r\n\r\n    it('should handle missing transaction data', async () => {\r\n        require('pdf-parse').default.mockResolvedValue({\r\n            text: 'Statement Period: 05/01/2025 to 05/31/2025\\nNo transactions found'\r\n        });\r\n\r\n        const buffer = Buffer.from('pdf with no transactions');\r\n        const result = await pdfParserService.parsePDF(buffer);\r\n\r\n        expect(result.transactions).toHaveLength(0);\r\n    });\r\n\r\n    it('should extract account information correctly', async () => {\r\n        require('pdf-parse').default.mockResolvedValue({\r\n            text: `\r\n                Statement Period: 06/01/2025 to 06/30/2025\r\n                Account Holder: Jane Smith\r\n                Account Number: ****5678\r\n            `\r\n        });\r\n\r\n        const buffer = Buffer.from('mock pdf content');\r\n        const result = await pdfParserService.parsePDF(buffer);\r\n\r\n        expect(result.accountInfo).toEqual({\r\n            accountHolder: 'Jane Smith',\r\n            accountNumber: '****5678',\r\n            statementPeriod: {\r\n                start: '06/01/2025',\r\n                end: '06/30/2025'\r\n            }\r\n        });\r\n    });\r\n});"],"mappings":"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","ignoreList":[]}