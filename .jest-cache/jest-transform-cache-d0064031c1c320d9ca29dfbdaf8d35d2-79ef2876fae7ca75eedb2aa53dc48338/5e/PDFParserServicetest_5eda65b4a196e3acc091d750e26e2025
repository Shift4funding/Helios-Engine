7fd62c813a858140129b15c54e7b4501
"use strict";

const PDFParserService = require('../../src/services/pdfParserService');
const fs = require('fs').promises;
const path = require('path');
describe('PDFParserService', () => {
  let samplePDFBuffer;
  beforeAll(async () => {
    const pdfPath = path.join(__dirname, '../fixtures/sample-statement.pdf');
    try {
      // Valid PDF structure
      const validPDF = `%PDF-1.4
%����
1 0 obj
<< /Type /Catalog
   /Pages 2 0 R
>>
endobj
2 0 obj
<< /Type /Pages
   /Kids [3 0 R]
   /Count 1
>>
endobj
3 0 obj
<< /Type /Page
   /Parent 2 0 R
   /MediaBox [0 0 612 792]
   /Contents 4 0 R
>>
endobj
4 0 obj
<< /Length 100 >>
stream
BT
/F1 12 Tf
72 720 Td
(05/15/23 GROCERY STORE PURCHASE -123.45
05/16/23 SALARY DEPOSIT 2500.00
05/17/23 UTILITY BILL -85.99) Tj
ET
endstream
endobj
xref
0 5
0000000000 65535 f
0000000010 00000 n
0000000060 00000 n
0000000120 00000 n
0000000200 00000 n
trailer
<< /Size 5
   /Root 1 0 R
>>
startxref
350
%%EOF`;
      await fs.writeFile(pdfPath, validPDF);
      samplePDFBuffer = Buffer.from(validPDF);
    } catch (error) {
      console.error('Failed to create test PDF:', error);
      throw error;
    }
  });
  it('should parse Chase bank statement format', async () => {
    const result = await PDFParserService.parseStatement(samplePDFBuffer, 'CHASE');
    expect(result).toHaveProperty('transactions');
    expect(result.transactions.length).toBeGreaterThan(0);
    const firstTransaction = result.transactions[0];
    expect(firstTransaction).toEqual({
      date: '05/15/23',
      description: 'GROCERY STORE PURCHASE',
      amount: -123.45
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQREZQYXJzZXJTZXJ2aWNlIiwicmVxdWlyZSIsImZzIiwicHJvbWlzZXMiLCJwYXRoIiwiZGVzY3JpYmUiLCJzYW1wbGVQREZCdWZmZXIiLCJiZWZvcmVBbGwiLCJwZGZQYXRoIiwiam9pbiIsIl9fZGlybmFtZSIsInZhbGlkUERGIiwid3JpdGVGaWxlIiwiQnVmZmVyIiwiZnJvbSIsImVycm9yIiwiY29uc29sZSIsIml0IiwicmVzdWx0IiwicGFyc2VTdGF0ZW1lbnQiLCJleHBlY3QiLCJ0b0hhdmVQcm9wZXJ0eSIsInRyYW5zYWN0aW9ucyIsImxlbmd0aCIsInRvQmVHcmVhdGVyVGhhbiIsImZpcnN0VHJhbnNhY3Rpb24iLCJ0b0VxdWFsIiwiZGF0ZSIsImRlc2NyaXB0aW9uIiwiYW1vdW50Il0sInNvdXJjZXMiOlsiUERGUGFyc2VyU2VydmljZS50ZXN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFBERlBhcnNlclNlcnZpY2UgPSByZXF1aXJlKCcuLi8uLi9zcmMvc2VydmljZXMvcGRmUGFyc2VyU2VydmljZScpO1xyXG5jb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJykucHJvbWlzZXM7XHJcbmNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XHJcblxyXG5kZXNjcmliZSgnUERGUGFyc2VyU2VydmljZScsICgpID0+IHtcclxuICAgIGxldCBzYW1wbGVQREZCdWZmZXI7XHJcblxyXG4gICAgYmVmb3JlQWxsKGFzeW5jICgpID0+IHtcclxuICAgICAgICBjb25zdCBwZGZQYXRoID0gcGF0aC5qb2luKF9fZGlybmFtZSwgJy4uL2ZpeHR1cmVzL3NhbXBsZS1zdGF0ZW1lbnQucGRmJyk7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgLy8gVmFsaWQgUERGIHN0cnVjdHVyZVxyXG4gICAgICAgICAgICBjb25zdCB2YWxpZFBERiA9IGAlUERGLTEuNFxyXG4l77+977+977+977+9XHJcbjEgMCBvYmpcclxuPDwgL1R5cGUgL0NhdGFsb2dcclxuICAgL1BhZ2VzIDIgMCBSXHJcbj4+XHJcbmVuZG9ialxyXG4yIDAgb2JqXHJcbjw8IC9UeXBlIC9QYWdlc1xyXG4gICAvS2lkcyBbMyAwIFJdXHJcbiAgIC9Db3VudCAxXHJcbj4+XHJcbmVuZG9ialxyXG4zIDAgb2JqXHJcbjw8IC9UeXBlIC9QYWdlXHJcbiAgIC9QYXJlbnQgMiAwIFJcclxuICAgL01lZGlhQm94IFswIDAgNjEyIDc5Ml1cclxuICAgL0NvbnRlbnRzIDQgMCBSXHJcbj4+XHJcbmVuZG9ialxyXG40IDAgb2JqXHJcbjw8IC9MZW5ndGggMTAwID4+XHJcbnN0cmVhbVxyXG5CVFxyXG4vRjEgMTIgVGZcclxuNzIgNzIwIFRkXHJcbigwNS8xNS8yMyBHUk9DRVJZIFNUT1JFIFBVUkNIQVNFIC0xMjMuNDVcclxuMDUvMTYvMjMgU0FMQVJZIERFUE9TSVQgMjUwMC4wMFxyXG4wNS8xNy8yMyBVVElMSVRZIEJJTEwgLTg1Ljk5KSBUalxyXG5FVFxyXG5lbmRzdHJlYW1cclxuZW5kb2JqXHJcbnhyZWZcclxuMCA1XHJcbjAwMDAwMDAwMDAgNjU1MzUgZlxyXG4wMDAwMDAwMDEwIDAwMDAwIG5cclxuMDAwMDAwMDA2MCAwMDAwMCBuXHJcbjAwMDAwMDAxMjAgMDAwMDAgblxyXG4wMDAwMDAwMjAwIDAwMDAwIG5cclxudHJhaWxlclxyXG48PCAvU2l6ZSA1XHJcbiAgIC9Sb290IDEgMCBSXHJcbj4+XHJcbnN0YXJ0eHJlZlxyXG4zNTBcclxuJSVFT0ZgO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgZnMud3JpdGVGaWxlKHBkZlBhdGgsIHZhbGlkUERGKTtcclxuICAgICAgICAgICAgc2FtcGxlUERGQnVmZmVyID0gQnVmZmVyLmZyb20odmFsaWRQREYpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBjcmVhdGUgdGVzdCBQREY6JywgZXJyb3IpO1xyXG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHBhcnNlIENoYXNlIGJhbmsgc3RhdGVtZW50IGZvcm1hdCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBQREZQYXJzZXJTZXJ2aWNlLnBhcnNlU3RhdGVtZW50KHNhbXBsZVBERkJ1ZmZlciwgJ0NIQVNFJyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ3RyYW5zYWN0aW9ucycpO1xyXG4gICAgICAgIGV4cGVjdChyZXN1bHQudHJhbnNhY3Rpb25zLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IGZpcnN0VHJhbnNhY3Rpb24gPSByZXN1bHQudHJhbnNhY3Rpb25zWzBdO1xyXG4gICAgICAgIGV4cGVjdChmaXJzdFRyYW5zYWN0aW9uKS50b0VxdWFsKHtcclxuICAgICAgICAgICAgZGF0ZTogJzA1LzE1LzIzJyxcclxuICAgICAgICAgICAgZGVzY3JpcHRpb246ICdHUk9DRVJZIFNUT1JFIFBVUkNIQVNFJyxcclxuICAgICAgICAgICAgYW1vdW50OiAtMTIzLjQ1XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufSk7Il0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLGdCQUFnQixHQUFHQyxPQUFPLENBQUMscUNBQXFDLENBQUM7QUFDdkUsTUFBTUMsRUFBRSxHQUFHRCxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUNFLFFBQVE7QUFDakMsTUFBTUMsSUFBSSxHQUFHSCxPQUFPLENBQUMsTUFBTSxDQUFDO0FBRTVCSSxRQUFRLENBQUMsa0JBQWtCLEVBQUUsTUFBTTtFQUMvQixJQUFJQyxlQUFlO0VBRW5CQyxTQUFTLENBQUMsWUFBWTtJQUNsQixNQUFNQyxPQUFPLEdBQUdKLElBQUksQ0FBQ0ssSUFBSSxDQUFDQyxTQUFTLEVBQUUsa0NBQWtDLENBQUM7SUFDeEUsSUFBSTtNQUNBO01BQ0EsTUFBTUMsUUFBUSxHQUFHO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO01BRU0sTUFBTVQsRUFBRSxDQUFDVSxTQUFTLENBQUNKLE9BQU8sRUFBRUcsUUFBUSxDQUFDO01BQ3JDTCxlQUFlLEdBQUdPLE1BQU0sQ0FBQ0MsSUFBSSxDQUFDSCxRQUFRLENBQUM7SUFDM0MsQ0FBQyxDQUFDLE9BQU9JLEtBQUssRUFBRTtNQUNaQyxPQUFPLENBQUNELEtBQUssQ0FBQyw0QkFBNEIsRUFBRUEsS0FBSyxDQUFDO01BQ2xELE1BQU1BLEtBQUs7SUFDZjtFQUNKLENBQUMsQ0FBQztFQUVGRSxFQUFFLENBQUMsMENBQTBDLEVBQUUsWUFBWTtJQUN2RCxNQUFNQyxNQUFNLEdBQUcsTUFBTWxCLGdCQUFnQixDQUFDbUIsY0FBYyxDQUFDYixlQUFlLEVBQUUsT0FBTyxDQUFDO0lBRTlFYyxNQUFNLENBQUNGLE1BQU0sQ0FBQyxDQUFDRyxjQUFjLENBQUMsY0FBYyxDQUFDO0lBQzdDRCxNQUFNLENBQUNGLE1BQU0sQ0FBQ0ksWUFBWSxDQUFDQyxNQUFNLENBQUMsQ0FBQ0MsZUFBZSxDQUFDLENBQUMsQ0FBQztJQUVyRCxNQUFNQyxnQkFBZ0IsR0FBR1AsTUFBTSxDQUFDSSxZQUFZLENBQUMsQ0FBQyxDQUFDO0lBQy9DRixNQUFNLENBQUNLLGdCQUFnQixDQUFDLENBQUNDLE9BQU8sQ0FBQztNQUM3QkMsSUFBSSxFQUFFLFVBQVU7TUFDaEJDLFdBQVcsRUFBRSx3QkFBd0I7TUFDckNDLE1BQU0sRUFBRSxDQUFDO0lBQ2IsQ0FBQyxDQUFDO0VBQ04sQ0FBQyxDQUFDO0FBQ04sQ0FBQyxDQUFDIiwiaWdub3JlTGlzdCI6W119