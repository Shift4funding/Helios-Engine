19e66e2123d1b662e730f245dbe97e50
"use strict";

const mongoose = require('mongoose');
const {
  setupTestDatabase,
  cleanupTestDatabase
} = require('./testDb');
describe('Database Setup', () => {
  // Clean up before tests to ensure no existing connections
  beforeAll(async () => {
    await cleanupTestDatabase();
    await setupTestDatabase();
  });

  // Clean up after tests
  afterAll(async () => {
    await cleanupTestDatabase();
  });
  it('should connect to the test database', async () => {
    expect(mongoose.connection.readyState).toBe(1);
  });
  it('should be able to perform operations', async () => {
    // Create a new model for testing
    const TestModel = mongoose.model('Test', new mongoose.Schema({
      name: String
    }), 'tests');

    // Test CRUD operations
    const testDoc = new TestModel({
      name: 'test'
    });
    await testDoc.save();
    const found = await TestModel.findOne({
      name: 'test'
    });
    expect(found.name).toBe('test');

    // Clean up test data
    await TestModel.deleteMany({});
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJzZXR1cFRlc3REYXRhYmFzZSIsImNsZWFudXBUZXN0RGF0YWJhc2UiLCJkZXNjcmliZSIsImJlZm9yZUFsbCIsImFmdGVyQWxsIiwiaXQiLCJleHBlY3QiLCJjb25uZWN0aW9uIiwicmVhZHlTdGF0ZSIsInRvQmUiLCJUZXN0TW9kZWwiLCJtb2RlbCIsIlNjaGVtYSIsIm5hbWUiLCJTdHJpbmciLCJ0ZXN0RG9jIiwic2F2ZSIsImZvdW5kIiwiZmluZE9uZSIsImRlbGV0ZU1hbnkiXSwic291cmNlcyI6WyJ0ZXN0RGIudGVzdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJyk7XHJcbmNvbnN0IHsgc2V0dXBUZXN0RGF0YWJhc2UsIGNsZWFudXBUZXN0RGF0YWJhc2UgfSA9IHJlcXVpcmUoJy4vdGVzdERiJyk7XHJcblxyXG5kZXNjcmliZSgnRGF0YWJhc2UgU2V0dXAnLCAoKSA9PiB7XHJcbiAgICAvLyBDbGVhbiB1cCBiZWZvcmUgdGVzdHMgdG8gZW5zdXJlIG5vIGV4aXN0aW5nIGNvbm5lY3Rpb25zXHJcbiAgICBiZWZvcmVBbGwoYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIGF3YWl0IGNsZWFudXBUZXN0RGF0YWJhc2UoKTtcclxuICAgICAgICBhd2FpdCBzZXR1cFRlc3REYXRhYmFzZSgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gQ2xlYW4gdXAgYWZ0ZXIgdGVzdHNcclxuICAgIGFmdGVyQWxsKGFzeW5jICgpID0+IHtcclxuICAgICAgICBhd2FpdCBjbGVhbnVwVGVzdERhdGFiYXNlKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGNvbm5lY3QgdG8gdGhlIHRlc3QgZGF0YWJhc2UnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgZXhwZWN0KG1vbmdvb3NlLmNvbm5lY3Rpb24ucmVhZHlTdGF0ZSkudG9CZSgxKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgYmUgYWJsZSB0byBwZXJmb3JtIG9wZXJhdGlvbnMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgLy8gQ3JlYXRlIGEgbmV3IG1vZGVsIGZvciB0ZXN0aW5nXHJcbiAgICAgICAgY29uc3QgVGVzdE1vZGVsID0gbW9uZ29vc2UubW9kZWwoJ1Rlc3QnLCBuZXcgbW9uZ29vc2UuU2NoZW1hKHsgXHJcbiAgICAgICAgICAgIG5hbWU6IFN0cmluZyBcclxuICAgICAgICB9KSwgJ3Rlc3RzJyk7XHJcblxyXG4gICAgICAgIC8vIFRlc3QgQ1JVRCBvcGVyYXRpb25zXHJcbiAgICAgICAgY29uc3QgdGVzdERvYyA9IG5ldyBUZXN0TW9kZWwoeyBuYW1lOiAndGVzdCcgfSk7XHJcbiAgICAgICAgYXdhaXQgdGVzdERvYy5zYXZlKCk7XHJcblxyXG4gICAgICAgIGNvbnN0IGZvdW5kID0gYXdhaXQgVGVzdE1vZGVsLmZpbmRPbmUoeyBuYW1lOiAndGVzdCcgfSk7XHJcbiAgICAgICAgZXhwZWN0KGZvdW5kLm5hbWUpLnRvQmUoJ3Rlc3QnKTtcclxuXHJcbiAgICAgICAgLy8gQ2xlYW4gdXAgdGVzdCBkYXRhXHJcbiAgICAgICAgYXdhaXQgVGVzdE1vZGVsLmRlbGV0ZU1hbnkoe30pO1xyXG4gICAgfSk7XHJcbn0pOyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxVQUFVLENBQUM7QUFDcEMsTUFBTTtFQUFFQyxpQkFBaUI7RUFBRUM7QUFBb0IsQ0FBQyxHQUFHRixPQUFPLENBQUMsVUFBVSxDQUFDO0FBRXRFRyxRQUFRLENBQUMsZ0JBQWdCLEVBQUUsTUFBTTtFQUM3QjtFQUNBQyxTQUFTLENBQUMsWUFBWTtJQUNsQixNQUFNRixtQkFBbUIsQ0FBQyxDQUFDO0lBQzNCLE1BQU1ELGlCQUFpQixDQUFDLENBQUM7RUFDN0IsQ0FBQyxDQUFDOztFQUVGO0VBQ0FJLFFBQVEsQ0FBQyxZQUFZO0lBQ2pCLE1BQU1ILG1CQUFtQixDQUFDLENBQUM7RUFDL0IsQ0FBQyxDQUFDO0VBRUZJLEVBQUUsQ0FBQyxxQ0FBcUMsRUFBRSxZQUFZO0lBQ2xEQyxNQUFNLENBQUNSLFFBQVEsQ0FBQ1MsVUFBVSxDQUFDQyxVQUFVLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLENBQUMsQ0FBQztFQUNsRCxDQUFDLENBQUM7RUFFRkosRUFBRSxDQUFDLHNDQUFzQyxFQUFFLFlBQVk7SUFDbkQ7SUFDQSxNQUFNSyxTQUFTLEdBQUdaLFFBQVEsQ0FBQ2EsS0FBSyxDQUFDLE1BQU0sRUFBRSxJQUFJYixRQUFRLENBQUNjLE1BQU0sQ0FBQztNQUN6REMsSUFBSSxFQUFFQztJQUNWLENBQUMsQ0FBQyxFQUFFLE9BQU8sQ0FBQzs7SUFFWjtJQUNBLE1BQU1DLE9BQU8sR0FBRyxJQUFJTCxTQUFTLENBQUM7TUFBRUcsSUFBSSxFQUFFO0lBQU8sQ0FBQyxDQUFDO0lBQy9DLE1BQU1FLE9BQU8sQ0FBQ0MsSUFBSSxDQUFDLENBQUM7SUFFcEIsTUFBTUMsS0FBSyxHQUFHLE1BQU1QLFNBQVMsQ0FBQ1EsT0FBTyxDQUFDO01BQUVMLElBQUksRUFBRTtJQUFPLENBQUMsQ0FBQztJQUN2RFAsTUFBTSxDQUFDVyxLQUFLLENBQUNKLElBQUksQ0FBQyxDQUFDSixJQUFJLENBQUMsTUFBTSxDQUFDOztJQUUvQjtJQUNBLE1BQU1DLFNBQVMsQ0FBQ1MsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDO0VBQ2xDLENBQUMsQ0FBQztBQUNOLENBQUMsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==