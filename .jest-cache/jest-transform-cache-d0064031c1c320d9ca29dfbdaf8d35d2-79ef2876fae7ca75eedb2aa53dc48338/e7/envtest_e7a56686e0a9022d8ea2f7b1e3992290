4ee9e3355866b2dcd7f53bb0324dfb9e
"use strict";

const path = require('path');
describe('Environment Configuration', () => {
  const OLD_ENV = process.env;
  beforeEach(() => {
    jest.resetModules();
    process.env = {
      ...OLD_ENV,
      NODE_ENV: 'test',
      PORT: '3001',
      HOST: 'localhost',
      API_KEY: 'test-api-key',
      RATE_LIMIT_MAX: '100',
      RATE_LIMIT_WINDOW_MS: '900000',
      PERPLEXITY_API_KEY: 'test-perplexity-key',
      PERPLEXITY_API_URL: 'https://api.test.com',
      LOG_LEVEL: 'info',
      LOG_FORMAT: 'combined'
    };
  });
  afterAll(() => {
    process.env = OLD_ENV;
  });
  it('should load configuration with default values', () => {
    const config = require('../../src/config/env');
    expect(config.server.port).toBe(3001);
    expect(config.server.host).toBe('localhost');
    expect(config.logging.level).toBe('info');
    expect(config.security.apiKey).toBe('test-api-key');
  });
  it('should throw error when required values are missing', () => {
    delete process.env.API_KEY;
    delete process.env.PERPLEXITY_API_KEY;
    expect(() => {
      jest.isolateModules(() => {
        require('../../src/config/env');
      });
    }).toThrow(/Missing required configuration/);
  });
  it('should override defaults with environment values', () => {
    process.env.PORT = '4000';
    process.env.LOG_LEVEL = 'debug';
    const config = require('../../src/config/env');
    expect(config.server.port).toBe(4000);
    expect(config.logging.level).toBe('debug');
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJwYXRoIiwicmVxdWlyZSIsImRlc2NyaWJlIiwiT0xEX0VOViIsInByb2Nlc3MiLCJlbnYiLCJiZWZvcmVFYWNoIiwiamVzdCIsInJlc2V0TW9kdWxlcyIsIk5PREVfRU5WIiwiUE9SVCIsIkhPU1QiLCJBUElfS0VZIiwiUkFURV9MSU1JVF9NQVgiLCJSQVRFX0xJTUlUX1dJTkRPV19NUyIsIlBFUlBMRVhJVFlfQVBJX0tFWSIsIlBFUlBMRVhJVFlfQVBJX1VSTCIsIkxPR19MRVZFTCIsIkxPR19GT1JNQVQiLCJhZnRlckFsbCIsIml0IiwiY29uZmlnIiwiZXhwZWN0Iiwic2VydmVyIiwicG9ydCIsInRvQmUiLCJob3N0IiwibG9nZ2luZyIsImxldmVsIiwic2VjdXJpdHkiLCJhcGlLZXkiLCJpc29sYXRlTW9kdWxlcyIsInRvVGhyb3ciXSwic291cmNlcyI6WyJlbnYudGVzdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xyXG5cclxuZGVzY3JpYmUoJ0Vudmlyb25tZW50IENvbmZpZ3VyYXRpb24nLCAoKSA9PiB7XHJcbiAgICBjb25zdCBPTERfRU5WID0gcHJvY2Vzcy5lbnY7XHJcblxyXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgamVzdC5yZXNldE1vZHVsZXMoKTtcclxuICAgICAgICBwcm9jZXNzLmVudiA9IHtcclxuICAgICAgICAgICAgLi4uT0xEX0VOVixcclxuICAgICAgICAgICAgTk9ERV9FTlY6ICd0ZXN0JyxcclxuICAgICAgICAgICAgUE9SVDogJzMwMDEnLFxyXG4gICAgICAgICAgICBIT1NUOiAnbG9jYWxob3N0JyxcclxuICAgICAgICAgICAgQVBJX0tFWTogJ3Rlc3QtYXBpLWtleScsXHJcbiAgICAgICAgICAgIFJBVEVfTElNSVRfTUFYOiAnMTAwJyxcclxuICAgICAgICAgICAgUkFURV9MSU1JVF9XSU5ET1dfTVM6ICc5MDAwMDAnLFxyXG4gICAgICAgICAgICBQRVJQTEVYSVRZX0FQSV9LRVk6ICd0ZXN0LXBlcnBsZXhpdHkta2V5JyxcclxuICAgICAgICAgICAgUEVSUExFWElUWV9BUElfVVJMOiAnaHR0cHM6Ly9hcGkudGVzdC5jb20nLFxyXG4gICAgICAgICAgICBMT0dfTEVWRUw6ICdpbmZvJyxcclxuICAgICAgICAgICAgTE9HX0ZPUk1BVDogJ2NvbWJpbmVkJ1xyXG4gICAgICAgIH07XHJcbiAgICB9KTtcclxuXHJcbiAgICBhZnRlckFsbCgoKSA9PiB7XHJcbiAgICAgICAgcHJvY2Vzcy5lbnYgPSBPTERfRU5WO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBsb2FkIGNvbmZpZ3VyYXRpb24gd2l0aCBkZWZhdWx0IHZhbHVlcycsICgpID0+IHtcclxuICAgICAgICBjb25zdCBjb25maWcgPSByZXF1aXJlKCcuLi8uLi9zcmMvY29uZmlnL2VudicpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGV4cGVjdChjb25maWcuc2VydmVyLnBvcnQpLnRvQmUoMzAwMSk7XHJcbiAgICAgICAgZXhwZWN0KGNvbmZpZy5zZXJ2ZXIuaG9zdCkudG9CZSgnbG9jYWxob3N0Jyk7XHJcbiAgICAgICAgZXhwZWN0KGNvbmZpZy5sb2dnaW5nLmxldmVsKS50b0JlKCdpbmZvJyk7XHJcbiAgICAgICAgZXhwZWN0KGNvbmZpZy5zZWN1cml0eS5hcGlLZXkpLnRvQmUoJ3Rlc3QtYXBpLWtleScpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBlcnJvciB3aGVuIHJlcXVpcmVkIHZhbHVlcyBhcmUgbWlzc2luZycsICgpID0+IHtcclxuICAgICAgICBkZWxldGUgcHJvY2Vzcy5lbnYuQVBJX0tFWTtcclxuICAgICAgICBkZWxldGUgcHJvY2Vzcy5lbnYuUEVSUExFWElUWV9BUElfS0VZO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGV4cGVjdCgoKSA9PiB7XHJcbiAgICAgICAgICAgIGplc3QuaXNvbGF0ZU1vZHVsZXMoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmVxdWlyZSgnLi4vLi4vc3JjL2NvbmZpZy9lbnYnKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSkudG9UaHJvdygvTWlzc2luZyByZXF1aXJlZCBjb25maWd1cmF0aW9uLyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIG92ZXJyaWRlIGRlZmF1bHRzIHdpdGggZW52aXJvbm1lbnQgdmFsdWVzJywgKCkgPT4ge1xyXG4gICAgICAgIHByb2Nlc3MuZW52LlBPUlQgPSAnNDAwMCc7XHJcbiAgICAgICAgcHJvY2Vzcy5lbnYuTE9HX0xFVkVMID0gJ2RlYnVnJztcclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBjb25maWcgPSByZXF1aXJlKCcuLi8uLi9zcmMvY29uZmlnL2VudicpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGV4cGVjdChjb25maWcuc2VydmVyLnBvcnQpLnRvQmUoNDAwMCk7XHJcbiAgICAgICAgZXhwZWN0KGNvbmZpZy5sb2dnaW5nLmxldmVsKS50b0JlKCdkZWJ1ZycpO1xyXG4gICAgfSk7XHJcbn0pOyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxJQUFJLEdBQUdDLE9BQU8sQ0FBQyxNQUFNLENBQUM7QUFFNUJDLFFBQVEsQ0FBQywyQkFBMkIsRUFBRSxNQUFNO0VBQ3hDLE1BQU1DLE9BQU8sR0FBR0MsT0FBTyxDQUFDQyxHQUFHO0VBRTNCQyxVQUFVLENBQUMsTUFBTTtJQUNiQyxJQUFJLENBQUNDLFlBQVksQ0FBQyxDQUFDO0lBQ25CSixPQUFPLENBQUNDLEdBQUcsR0FBRztNQUNWLEdBQUdGLE9BQU87TUFDVk0sUUFBUSxFQUFFLE1BQU07TUFDaEJDLElBQUksRUFBRSxNQUFNO01BQ1pDLElBQUksRUFBRSxXQUFXO01BQ2pCQyxPQUFPLEVBQUUsY0FBYztNQUN2QkMsY0FBYyxFQUFFLEtBQUs7TUFDckJDLG9CQUFvQixFQUFFLFFBQVE7TUFDOUJDLGtCQUFrQixFQUFFLHFCQUFxQjtNQUN6Q0Msa0JBQWtCLEVBQUUsc0JBQXNCO01BQzFDQyxTQUFTLEVBQUUsTUFBTTtNQUNqQkMsVUFBVSxFQUFFO0lBQ2hCLENBQUM7RUFDTCxDQUFDLENBQUM7RUFFRkMsUUFBUSxDQUFDLE1BQU07SUFDWGYsT0FBTyxDQUFDQyxHQUFHLEdBQUdGLE9BQU87RUFDekIsQ0FBQyxDQUFDO0VBRUZpQixFQUFFLENBQUMsK0NBQStDLEVBQUUsTUFBTTtJQUN0RCxNQUFNQyxNQUFNLEdBQUdwQixPQUFPLENBQUMsc0JBQXNCLENBQUM7SUFFOUNxQixNQUFNLENBQUNELE1BQU0sQ0FBQ0UsTUFBTSxDQUFDQyxJQUFJLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLElBQUksQ0FBQztJQUNyQ0gsTUFBTSxDQUFDRCxNQUFNLENBQUNFLE1BQU0sQ0FBQ0csSUFBSSxDQUFDLENBQUNELElBQUksQ0FBQyxXQUFXLENBQUM7SUFDNUNILE1BQU0sQ0FBQ0QsTUFBTSxDQUFDTSxPQUFPLENBQUNDLEtBQUssQ0FBQyxDQUFDSCxJQUFJLENBQUMsTUFBTSxDQUFDO0lBQ3pDSCxNQUFNLENBQUNELE1BQU0sQ0FBQ1EsUUFBUSxDQUFDQyxNQUFNLENBQUMsQ0FBQ0wsSUFBSSxDQUFDLGNBQWMsQ0FBQztFQUN2RCxDQUFDLENBQUM7RUFFRkwsRUFBRSxDQUFDLHFEQUFxRCxFQUFFLE1BQU07SUFDNUQsT0FBT2hCLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDTyxPQUFPO0lBQzFCLE9BQU9SLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDVSxrQkFBa0I7SUFFckNPLE1BQU0sQ0FBQyxNQUFNO01BQ1RmLElBQUksQ0FBQ3dCLGNBQWMsQ0FBQyxNQUFNO1FBQ3RCOUIsT0FBTyxDQUFDLHNCQUFzQixDQUFDO01BQ25DLENBQUMsQ0FBQztJQUNOLENBQUMsQ0FBQyxDQUFDK0IsT0FBTyxDQUFDLGdDQUFnQyxDQUFDO0VBQ2hELENBQUMsQ0FBQztFQUVGWixFQUFFLENBQUMsa0RBQWtELEVBQUUsTUFBTTtJQUN6RGhCLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDSyxJQUFJLEdBQUcsTUFBTTtJQUN6Qk4sT0FBTyxDQUFDQyxHQUFHLENBQUNZLFNBQVMsR0FBRyxPQUFPO0lBRS9CLE1BQU1JLE1BQU0sR0FBR3BCLE9BQU8sQ0FBQyxzQkFBc0IsQ0FBQztJQUU5Q3FCLE1BQU0sQ0FBQ0QsTUFBTSxDQUFDRSxNQUFNLENBQUNDLElBQUksQ0FBQyxDQUFDQyxJQUFJLENBQUMsSUFBSSxDQUFDO0lBQ3JDSCxNQUFNLENBQUNELE1BQU0sQ0FBQ00sT0FBTyxDQUFDQyxLQUFLLENBQUMsQ0FBQ0gsSUFBSSxDQUFDLE9BQU8sQ0FBQztFQUM5QyxDQUFDLENBQUM7QUFDTixDQUFDLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=