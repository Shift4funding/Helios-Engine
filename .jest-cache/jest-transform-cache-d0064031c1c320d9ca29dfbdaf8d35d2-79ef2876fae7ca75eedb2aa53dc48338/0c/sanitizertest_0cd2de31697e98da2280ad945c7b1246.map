{"version":3,"names":["sanitizeRequest","sanitizeValue","sanitizeObject","require","describe","mockReq","mockRes","mockNext","beforeEach","body","query","params","jest","fn","it","text","nested","html","expect","toBe","items","number","boolean","null","toEqual","file","buffer","Buffer","from"],"sources":["sanitizer.test.js"],"sourcesContent":["const { sanitizeRequest, sanitizeValue, sanitizeObject } = require('../../src/middleware/sanitizer');\r\n\r\ndescribe('Sanitization Middleware', () => {\r\n    let mockReq;\r\n    let mockRes;\r\n    let mockNext;\r\n\r\n    beforeEach(() => {\r\n        mockReq = {\r\n            body: {},\r\n            query: {},\r\n            params: {}\r\n        };\r\n        mockRes = {};\r\n        mockNext = jest.fn();\r\n    });\r\n\r\n    it('should sanitize HTML in request body', () => {\r\n        mockReq.body = {\r\n            text: '<script>alert(\"xss\")</script>Hello',\r\n            nested: {\r\n                html: '<img src=\"x\" onerror=\"alert(1)\">'\r\n            }\r\n        };\r\n\r\n        sanitizeRequest(mockReq, mockRes, mockNext);\r\n\r\n        expect(mockReq.body.text).toBe('Hello');\r\n        expect(mockReq.body.nested.html).toBe('');\r\n    });\r\n\r\n    it('should handle arrays in request body', () => {\r\n        mockReq.body = {\r\n            items: ['<b>test</b>', '<script>alert(1)</script>']\r\n        };\r\n\r\n        sanitizeRequest(mockReq, mockRes, mockNext);\r\n\r\n        expect(mockReq.body.items[0]).toBe('test');\r\n        expect(mockReq.body.items[1]).toBe('');\r\n    });\r\n\r\n    it('should preserve non-string values', () => {\r\n        mockReq.body = {\r\n            number: 123,\r\n            boolean: true,\r\n            null: null\r\n        };\r\n\r\n        sanitizeRequest(mockReq, mockRes, mockNext);\r\n\r\n        expect(mockReq.body).toEqual({\r\n            number: 123,\r\n            boolean: true,\r\n            null: null\r\n        });\r\n    });\r\n\r\n    it('should skip file uploads', () => {\r\n        const file = { buffer: Buffer.from('test') };\r\n        mockReq.file = file;\r\n        mockReq.body = { text: 'test' };\r\n\r\n        sanitizeRequest(mockReq, mockRes, mockNext);\r\n\r\n        expect(mockReq.file).toBe(file);\r\n        expect(mockReq.body.text).toBe('test');\r\n    });\r\n});"],"mappings":";;AAAA,MAAM;EAAEA,eAAe;EAAEC,aAAa;EAAEC;AAAe,CAAC,GAAGC,OAAO,CAAC,gCAAgC,CAAC;AAEpGC,QAAQ,CAAC,yBAAyB,EAAE,MAAM;EACtC,IAAIC,OAAO;EACX,IAAIC,OAAO;EACX,IAAIC,QAAQ;EAEZC,UAAU,CAAC,MAAM;IACbH,OAAO,GAAG;MACNI,IAAI,EAAE,CAAC,CAAC;MACRC,KAAK,EAAE,CAAC,CAAC;MACTC,MAAM,EAAE,CAAC;IACb,CAAC;IACDL,OAAO,GAAG,CAAC,CAAC;IACZC,QAAQ,GAAGK,IAAI,CAACC,EAAE,CAAC,CAAC;EACxB,CAAC,CAAC;EAEFC,EAAE,CAAC,sCAAsC,EAAE,MAAM;IAC7CT,OAAO,CAACI,IAAI,GAAG;MACXM,IAAI,EAAE,oCAAoC;MAC1CC,MAAM,EAAE;QACJC,IAAI,EAAE;MACV;IACJ,CAAC;IAEDjB,eAAe,CAACK,OAAO,EAAEC,OAAO,EAAEC,QAAQ,CAAC;IAE3CW,MAAM,CAACb,OAAO,CAACI,IAAI,CAACM,IAAI,CAAC,CAACI,IAAI,CAAC,OAAO,CAAC;IACvCD,MAAM,CAACb,OAAO,CAACI,IAAI,CAACO,MAAM,CAACC,IAAI,CAAC,CAACE,IAAI,CAAC,EAAE,CAAC;EAC7C,CAAC,CAAC;EAEFL,EAAE,CAAC,sCAAsC,EAAE,MAAM;IAC7CT,OAAO,CAACI,IAAI,GAAG;MACXW,KAAK,EAAE,CAAC,aAAa,EAAE,2BAA2B;IACtD,CAAC;IAEDpB,eAAe,CAACK,OAAO,EAAEC,OAAO,EAAEC,QAAQ,CAAC;IAE3CW,MAAM,CAACb,OAAO,CAACI,IAAI,CAACW,KAAK,CAAC,CAAC,CAAC,CAAC,CAACD,IAAI,CAAC,MAAM,CAAC;IAC1CD,MAAM,CAACb,OAAO,CAACI,IAAI,CAACW,KAAK,CAAC,CAAC,CAAC,CAAC,CAACD,IAAI,CAAC,EAAE,CAAC;EAC1C,CAAC,CAAC;EAEFL,EAAE,CAAC,mCAAmC,EAAE,MAAM;IAC1CT,OAAO,CAACI,IAAI,GAAG;MACXY,MAAM,EAAE,GAAG;MACXC,OAAO,EAAE,IAAI;MACbC,IAAI,EAAE;IACV,CAAC;IAEDvB,eAAe,CAACK,OAAO,EAAEC,OAAO,EAAEC,QAAQ,CAAC;IAE3CW,MAAM,CAACb,OAAO,CAACI,IAAI,CAAC,CAACe,OAAO,CAAC;MACzBH,MAAM,EAAE,GAAG;MACXC,OAAO,EAAE,IAAI;MACbC,IAAI,EAAE;IACV,CAAC,CAAC;EACN,CAAC,CAAC;EAEFT,EAAE,CAAC,0BAA0B,EAAE,MAAM;IACjC,MAAMW,IAAI,GAAG;MAAEC,MAAM,EAAEC,MAAM,CAACC,IAAI,CAAC,MAAM;IAAE,CAAC;IAC5CvB,OAAO,CAACoB,IAAI,GAAGA,IAAI;IACnBpB,OAAO,CAACI,IAAI,GAAG;MAAEM,IAAI,EAAE;IAAO,CAAC;IAE/Bf,eAAe,CAACK,OAAO,EAAEC,OAAO,EAAEC,QAAQ,CAAC;IAE3CW,MAAM,CAACb,OAAO,CAACoB,IAAI,CAAC,CAACN,IAAI,CAACM,IAAI,CAAC;IAC/BP,MAAM,CAACb,OAAO,CAACI,IAAI,CAACM,IAAI,CAAC,CAACI,IAAI,CAAC,MAAM,CAAC;EAC1C,CAAC,CAAC;AACN,CAAC,CAAC","ignoreList":[]}