{"version":3,"names":["request","require","express","rateLimiter","validateApiKey","describe","app","beforeEach","use","json","process","env","API_KEY","get","req","res","success","it","response","set","expect","status","toBe","i"],"sources":["security.test.js"],"sourcesContent":["const request = require('supertest');\r\nconst express = require('express');\r\nconst { rateLimiter, validateApiKey } = require('../../src/middleware/security');\r\n\r\ndescribe('Security Middleware', () => {\r\n    let app;\r\n\r\n    beforeEach(() => {\r\n        app = express();\r\n        app.use(express.json());\r\n    });\r\n\r\n    describe('API Key Validation', () => {\r\n        beforeEach(() => {\r\n            process.env.API_KEY = 'test-api-key';\r\n            app.use(validateApiKey);\r\n            app.get('/test', (req, res) => res.json({ success: true }));\r\n        });\r\n\r\n        it('should allow requests with valid API key', async () => {\r\n            const response = await request(app)\r\n                .get('/test')\r\n                .set('X-API-Key', 'test-api-key');\r\n\r\n            expect(response.status).toBe(200);\r\n        });\r\n\r\n        it('should reject requests without API key', async () => {\r\n            const response = await request(app)\r\n                .get('/test');\r\n\r\n            expect(response.status).toBe(401);\r\n        });\r\n    });\r\n\r\n    describe('Rate Limiting', () => {\r\n        beforeEach(() => {\r\n            app.use(rateLimiter);\r\n            app.get('/test', (req, res) => res.json({ success: true }));\r\n        });\r\n\r\n        it('should allow requests within rate limit', async () => {\r\n            const response = await request(app)\r\n                .get('/test');\r\n\r\n            expect(response.status).toBe(200);\r\n        });\r\n\r\n        it('should block excessive requests', async () => {\r\n            // Make more requests than the limit\r\n            for (let i = 0; i < 101; i++) {\r\n                await request(app).get('/test');\r\n            }\r\n\r\n            const response = await request(app)\r\n                .get('/test');\r\n\r\n            expect(response.status).toBe(429);\r\n        });\r\n    });\r\n});"],"mappings":";;AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,WAAW,CAAC;AACpC,MAAMC,OAAO,GAAGD,OAAO,CAAC,SAAS,CAAC;AAClC,MAAM;EAAEE,WAAW;EAAEC;AAAe,CAAC,GAAGH,OAAO,CAAC,+BAA+B,CAAC;AAEhFI,QAAQ,CAAC,qBAAqB,EAAE,MAAM;EAClC,IAAIC,GAAG;EAEPC,UAAU,CAAC,MAAM;IACbD,GAAG,GAAGJ,OAAO,CAAC,CAAC;IACfI,GAAG,CAACE,GAAG,CAACN,OAAO,CAACO,IAAI,CAAC,CAAC,CAAC;EAC3B,CAAC,CAAC;EAEFJ,QAAQ,CAAC,oBAAoB,EAAE,MAAM;IACjCE,UAAU,CAAC,MAAM;MACbG,OAAO,CAACC,GAAG,CAACC,OAAO,GAAG,cAAc;MACpCN,GAAG,CAACE,GAAG,CAACJ,cAAc,CAAC;MACvBE,GAAG,CAACO,GAAG,CAAC,OAAO,EAAE,CAACC,GAAG,EAAEC,GAAG,KAAKA,GAAG,CAACN,IAAI,CAAC;QAAEO,OAAO,EAAE;MAAK,CAAC,CAAC,CAAC;IAC/D,CAAC,CAAC;IAEFC,EAAE,CAAC,0CAA0C,EAAE,YAAY;MACvD,MAAMC,QAAQ,GAAG,MAAMlB,OAAO,CAACM,GAAG,CAAC,CAC9BO,GAAG,CAAC,OAAO,CAAC,CACZM,GAAG,CAAC,WAAW,EAAE,cAAc,CAAC;MAErCC,MAAM,CAACF,QAAQ,CAACG,MAAM,CAAC,CAACC,IAAI,CAAC,GAAG,CAAC;IACrC,CAAC,CAAC;IAEFL,EAAE,CAAC,wCAAwC,EAAE,YAAY;MACrD,MAAMC,QAAQ,GAAG,MAAMlB,OAAO,CAACM,GAAG,CAAC,CAC9BO,GAAG,CAAC,OAAO,CAAC;MAEjBO,MAAM,CAACF,QAAQ,CAACG,MAAM,CAAC,CAACC,IAAI,CAAC,GAAG,CAAC;IACrC,CAAC,CAAC;EACN,CAAC,CAAC;EAEFjB,QAAQ,CAAC,eAAe,EAAE,MAAM;IAC5BE,UAAU,CAAC,MAAM;MACbD,GAAG,CAACE,GAAG,CAACL,WAAW,CAAC;MACpBG,GAAG,CAACO,GAAG,CAAC,OAAO,EAAE,CAACC,GAAG,EAAEC,GAAG,KAAKA,GAAG,CAACN,IAAI,CAAC;QAAEO,OAAO,EAAE;MAAK,CAAC,CAAC,CAAC;IAC/D,CAAC,CAAC;IAEFC,EAAE,CAAC,yCAAyC,EAAE,YAAY;MACtD,MAAMC,QAAQ,GAAG,MAAMlB,OAAO,CAACM,GAAG,CAAC,CAC9BO,GAAG,CAAC,OAAO,CAAC;MAEjBO,MAAM,CAACF,QAAQ,CAACG,MAAM,CAAC,CAACC,IAAI,CAAC,GAAG,CAAC;IACrC,CAAC,CAAC;IAEFL,EAAE,CAAC,iCAAiC,EAAE,YAAY;MAC9C;MACA,KAAK,IAAIM,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,GAAG,EAAEA,CAAC,EAAE,EAAE;QAC1B,MAAMvB,OAAO,CAACM,GAAG,CAAC,CAACO,GAAG,CAAC,OAAO,CAAC;MACnC;MAEA,MAAMK,QAAQ,GAAG,MAAMlB,OAAO,CAACM,GAAG,CAAC,CAC9BO,GAAG,CAAC,OAAO,CAAC;MAEjBO,MAAM,CAACF,QAAQ,CAACG,MAAM,CAAC,CAACC,IAAI,CAAC,GAAG,CAAC;IACrC,CAAC,CAAC;EACN,CAAC,CAAC;AACN,CAAC,CAAC","ignoreList":[]}