{"version":3,"names":["pdfParse","require","logger","BankFormatFactory","ChaseParser","BOAParser","WellsFargoParser","PDFParserService","constructor","parsers","CHASE","BANK_OF_AMERICA","WELLS_FARGO","parseStatement","buffer","bankType","parser","Error","data","parse","validateTransactions","error","formatter","getFormatter","metadata","transactions","parseTransactions","text","pageCount","parsed","Date","toISOString","module","exports"],"sources":["pdfParserService.js"],"sourcesContent":["const pdfParse = require('pdf-parse');\r\nconst logger = require('../config/logger');\r\nconst BankFormatFactory = require('../utils/bankFormatFactory');\r\nconst ChaseParser = require('../parsers/chaseParser');\r\nconst BOAParser = require('../parsers/boaParser');\r\nconst WellsFargoParser = require('../parsers/wellsFargoParser');\r\n\r\nclass PDFParserService {\r\n    constructor() {\r\n        this.parsers = {\r\n            CHASE: new ChaseParser(),\r\n            BANK_OF_AMERICA: new BOAParser(),\r\n            WELLS_FARGO: new WellsFargoParser()\r\n        };\r\n    }\r\n\r\n    async parseStatement(buffer, bankType = 'CHASE') {\r\n        try {\r\n            const parser = this.parsers[bankType];\r\n            if (!parser) {\r\n                throw new Error(`Unsupported bank type: ${bankType}`);\r\n            }\r\n\r\n            const data = await parser.parse(buffer);\r\n            return this.validateTransactions(data);\r\n        } catch (error) {\r\n            logger.error('PDF parsing failed:', error);\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    validateTransactions(data) {\r\n        const formatter = BankFormatFactory.getFormatter(data.metadata.bankType);\r\n        const transactions = formatter.parseTransactions(data.text);\r\n        \r\n        return {\r\n            transactions,\r\n            metadata: {\r\n                pageCount: data.metadata.pageCount,\r\n                bankType: data.metadata.bankType,\r\n                parsed: new Date().toISOString()\r\n            }\r\n        };\r\n    }\r\n}\r\n\r\nmodule.exports = new PDFParserService();"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,WAAW,CAAC;AACrC,MAAMC,MAAM,GAAGD,OAAO,CAAC,kBAAkB,CAAC;AAC1C,MAAME,iBAAiB,GAAGF,OAAO,CAAC,4BAA4B,CAAC;AAC/D,MAAMG,WAAW,GAAGH,OAAO,CAAC,wBAAwB,CAAC;AACrD,MAAMI,SAAS,GAAGJ,OAAO,CAAC,sBAAsB,CAAC;AACjD,MAAMK,gBAAgB,GAAGL,OAAO,CAAC,6BAA6B,CAAC;AAE/D,MAAMM,gBAAgB,CAAC;EACnBC,WAAWA,CAAA,EAAG;IACV,IAAI,CAACC,OAAO,GAAG;MACXC,KAAK,EAAE,IAAIN,WAAW,CAAC,CAAC;MACxBO,eAAe,EAAE,IAAIN,SAAS,CAAC,CAAC;MAChCO,WAAW,EAAE,IAAIN,gBAAgB,CAAC;IACtC,CAAC;EACL;EAEA,MAAMO,cAAcA,CAACC,MAAM,EAAEC,QAAQ,GAAG,OAAO,EAAE;IAC7C,IAAI;MACA,MAAMC,MAAM,GAAG,IAAI,CAACP,OAAO,CAACM,QAAQ,CAAC;MACrC,IAAI,CAACC,MAAM,EAAE;QACT,MAAM,IAAIC,KAAK,CAAC,0BAA0BF,QAAQ,EAAE,CAAC;MACzD;MAEA,MAAMG,IAAI,GAAG,MAAMF,MAAM,CAACG,KAAK,CAACL,MAAM,CAAC;MACvC,OAAO,IAAI,CAACM,oBAAoB,CAACF,IAAI,CAAC;IAC1C,CAAC,CAAC,OAAOG,KAAK,EAAE;MACZnB,MAAM,CAACmB,KAAK,CAAC,qBAAqB,EAAEA,KAAK,CAAC;MAC1C,MAAMA,KAAK;IACf;EACJ;EAEAD,oBAAoBA,CAACF,IAAI,EAAE;IACvB,MAAMI,SAAS,GAAGnB,iBAAiB,CAACoB,YAAY,CAACL,IAAI,CAACM,QAAQ,CAACT,QAAQ,CAAC;IACxE,MAAMU,YAAY,GAAGH,SAAS,CAACI,iBAAiB,CAACR,IAAI,CAACS,IAAI,CAAC;IAE3D,OAAO;MACHF,YAAY;MACZD,QAAQ,EAAE;QACNI,SAAS,EAAEV,IAAI,CAACM,QAAQ,CAACI,SAAS;QAClCb,QAAQ,EAAEG,IAAI,CAACM,QAAQ,CAACT,QAAQ;QAChCc,MAAM,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;MACnC;IACJ,CAAC;EACL;AACJ;AAEAC,MAAM,CAACC,OAAO,GAAG,IAAI1B,gBAAgB,CAAC,CAAC","ignoreList":[]}