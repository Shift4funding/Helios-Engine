{"version":3,"names":["request","require","path","app","describe","FIXTURES_PATH","join","__dirname","test","response","post","attach","expect","status","toBe","body","toHaveProperty","set","process","env","API_KEY","data"],"sources":["analysisRoutes.test.js"],"sourcesContent":["const request = require('supertest');\r\nconst path = require('path');\r\nconst app = require('../../src/app');\r\n\r\ndescribe('Analysis Routes', () => {\r\n    const FIXTURES_PATH = path.join(__dirname, '../fixtures');\r\n\r\n    test('should reject requests without API key', async () => {\r\n        const response = await request(app)\r\n            .post('/api/analysis/statement')\r\n            .attach('bankStatement', path.join(FIXTURES_PATH, 'sample-statement.pdf'));\r\n\r\n        expect(response.status).toBe(401);\r\n        expect(response.body).toHaveProperty('status', 'error');\r\n        expect(response.body).toHaveProperty('message', 'Invalid or missing API key');\r\n    });\r\n\r\n    test('should handle PDF upload and analysis', async () => {\r\n        const response = await request(app)\r\n            .post('/api/analysis/statement')\r\n            .set('X-API-Key', process.env.API_KEY)\r\n            .attach('bankStatement', path.join(FIXTURES_PATH, 'sample-statement.pdf'));\r\n\r\n        expect(response.status).toBe(200);\r\n        expect(response.body).toHaveProperty('success', true);\r\n        expect(response.body.data).toHaveProperty('parsedStatement');\r\n        expect(response.body.data).toHaveProperty('analysis');\r\n    });\r\n\r\n    test('should reject non-PDF files', async () => {\r\n        const response = await request(app)\r\n            .post('/api/analysis/statement')\r\n            .set('X-API-Key', process.env.API_KEY)\r\n            .attach('bankStatement', path.join(FIXTURES_PATH, 'not-a-pdf.txt'));\r\n\r\n        expect(response.status).toBe(400);\r\n        expect(response.body).toHaveProperty('status', 'error');\r\n        expect(response.body).toHaveProperty('message', 'Only PDF files are allowed');\r\n    });\r\n});"],"mappings":";;AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,WAAW,CAAC;AACpC,MAAMC,IAAI,GAAGD,OAAO,CAAC,MAAM,CAAC;AAC5B,MAAME,GAAG,GAAGF,OAAO,CAAC,eAAe,CAAC;AAEpCG,QAAQ,CAAC,iBAAiB,EAAE,MAAM;EAC9B,MAAMC,aAAa,GAAGH,IAAI,CAACI,IAAI,CAACC,SAAS,EAAE,aAAa,CAAC;EAEzDC,IAAI,CAAC,wCAAwC,EAAE,YAAY;IACvD,MAAMC,QAAQ,GAAG,MAAMT,OAAO,CAACG,GAAG,CAAC,CAC9BO,IAAI,CAAC,yBAAyB,CAAC,CAC/BC,MAAM,CAAC,eAAe,EAAET,IAAI,CAACI,IAAI,CAACD,aAAa,EAAE,sBAAsB,CAAC,CAAC;IAE9EO,MAAM,CAACH,QAAQ,CAACI,MAAM,CAAC,CAACC,IAAI,CAAC,GAAG,CAAC;IACjCF,MAAM,CAACH,QAAQ,CAACM,IAAI,CAAC,CAACC,cAAc,CAAC,QAAQ,EAAE,OAAO,CAAC;IACvDJ,MAAM,CAACH,QAAQ,CAACM,IAAI,CAAC,CAACC,cAAc,CAAC,SAAS,EAAE,4BAA4B,CAAC;EACjF,CAAC,CAAC;EAEFR,IAAI,CAAC,uCAAuC,EAAE,YAAY;IACtD,MAAMC,QAAQ,GAAG,MAAMT,OAAO,CAACG,GAAG,CAAC,CAC9BO,IAAI,CAAC,yBAAyB,CAAC,CAC/BO,GAAG,CAAC,WAAW,EAAEC,OAAO,CAACC,GAAG,CAACC,OAAO,CAAC,CACrCT,MAAM,CAAC,eAAe,EAAET,IAAI,CAACI,IAAI,CAACD,aAAa,EAAE,sBAAsB,CAAC,CAAC;IAE9EO,MAAM,CAACH,QAAQ,CAACI,MAAM,CAAC,CAACC,IAAI,CAAC,GAAG,CAAC;IACjCF,MAAM,CAACH,QAAQ,CAACM,IAAI,CAAC,CAACC,cAAc,CAAC,SAAS,EAAE,IAAI,CAAC;IACrDJ,MAAM,CAACH,QAAQ,CAACM,IAAI,CAACM,IAAI,CAAC,CAACL,cAAc,CAAC,iBAAiB,CAAC;IAC5DJ,MAAM,CAACH,QAAQ,CAACM,IAAI,CAACM,IAAI,CAAC,CAACL,cAAc,CAAC,UAAU,CAAC;EACzD,CAAC,CAAC;EAEFR,IAAI,CAAC,6BAA6B,EAAE,YAAY;IAC5C,MAAMC,QAAQ,GAAG,MAAMT,OAAO,CAACG,GAAG,CAAC,CAC9BO,IAAI,CAAC,yBAAyB,CAAC,CAC/BO,GAAG,CAAC,WAAW,EAAEC,OAAO,CAACC,GAAG,CAACC,OAAO,CAAC,CACrCT,MAAM,CAAC,eAAe,EAAET,IAAI,CAACI,IAAI,CAACD,aAAa,EAAE,eAAe,CAAC,CAAC;IAEvEO,MAAM,CAACH,QAAQ,CAACI,MAAM,CAAC,CAACC,IAAI,CAAC,GAAG,CAAC;IACjCF,MAAM,CAACH,QAAQ,CAACM,IAAI,CAAC,CAACC,cAAc,CAAC,QAAQ,EAAE,OAAO,CAAC;IACvDJ,MAAM,CAACH,QAAQ,CAACM,IAAI,CAAC,CAACC,cAAc,CAAC,SAAS,EAAE,4BAA4B,CAAC;EACjF,CAAC,CAAC;AACN,CAAC,CAAC","ignoreList":[]}