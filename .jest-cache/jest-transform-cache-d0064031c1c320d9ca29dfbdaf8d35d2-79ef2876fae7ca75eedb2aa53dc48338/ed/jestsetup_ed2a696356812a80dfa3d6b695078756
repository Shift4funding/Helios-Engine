9d4545b4107c76cb5393dcbd45a63bdb
"use strict";

// Mock modules before any tests run
_getJestObj().mock('./src/config/logger', () => mockLogger);
_getJestObj().mock('./src/services/perplexityService', () => {
  return jest.fn().mockImplementation(() => ({
    analyzeText: jest.fn().mockResolvedValue({
      category: 'uncategorized'
    }),
    getSuggestions: jest.fn().mockResolvedValue([])
  }));
});
_getJestObj().mock('./src/services/RedisService', () => ({
  get: jest.fn().mockResolvedValue(null),
  set: jest.fn().mockResolvedValue('OK'),
  del: jest.fn().mockResolvedValue(1)
}));
_getJestObj().mock('natural', () => ({
  BayesClassifier: jest.fn().mockImplementation(() => ({
    addDocument: jest.fn(),
    train: jest.fn(),
    classify: jest.fn().mockReturnValue('uncategorized')
  }))
}));

// Make mocks available globally
function _getJestObj() {
  const {
    jest
  } = require("@jest/globals");
  _getJestObj = () => jest;
  return jest;
}
jest.setTimeout(30000);

// Setup global mocks
const mockLogger = {
  error: jest.fn(),
  info: jest.fn(),
  warn: jest.fn(),
  debug: jest.fn()
};
global.__mocks__ = {
  logger: mockLogger
};

// Cleanup all mocks after each test
afterEach(() => {
  jest.clearAllMocks();
  jest.resetModules();
});

// Handle unhandled promise rejections
process.on('unhandledRejection', error => {
  console.error('Unhandled Promise Rejection:', error);
});

// Global test setup
global.console = {
  ...console,
  error: jest.fn(),
  warn: jest.fn(),
  log: jest.fn()
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2V0SmVzdE9iaiIsIm1vY2siLCJtb2NrTG9nZ2VyIiwiamVzdCIsImZuIiwibW9ja0ltcGxlbWVudGF0aW9uIiwiYW5hbHl6ZVRleHQiLCJtb2NrUmVzb2x2ZWRWYWx1ZSIsImNhdGVnb3J5IiwiZ2V0U3VnZ2VzdGlvbnMiLCJnZXQiLCJzZXQiLCJkZWwiLCJCYXllc0NsYXNzaWZpZXIiLCJhZGREb2N1bWVudCIsInRyYWluIiwiY2xhc3NpZnkiLCJtb2NrUmV0dXJuVmFsdWUiLCJyZXF1aXJlIiwic2V0VGltZW91dCIsImVycm9yIiwiaW5mbyIsIndhcm4iLCJkZWJ1ZyIsImdsb2JhbCIsIl9fbW9ja3NfXyIsImxvZ2dlciIsImFmdGVyRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJyZXNldE1vZHVsZXMiLCJwcm9jZXNzIiwib24iLCJjb25zb2xlIiwibG9nIl0sInNvdXJjZXMiOlsiamVzdC5zZXR1cC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJqZXN0LnNldFRpbWVvdXQoMzAwMDApO1xyXG5cclxuLy8gU2V0dXAgZ2xvYmFsIG1vY2tzXHJcbmNvbnN0IG1vY2tMb2dnZXIgPSB7XHJcbiAgICBlcnJvcjogamVzdC5mbigpLFxyXG4gICAgaW5mbzogamVzdC5mbigpLFxyXG4gICAgd2FybjogamVzdC5mbigpLFxyXG4gICAgZGVidWc6IGplc3QuZm4oKVxyXG59O1xyXG5cclxuLy8gTW9jayBtb2R1bGVzIGJlZm9yZSBhbnkgdGVzdHMgcnVuXHJcbmplc3QubW9jaygnLi9zcmMvY29uZmlnL2xvZ2dlcicsICgpID0+IG1vY2tMb2dnZXIpO1xyXG5qZXN0Lm1vY2soJy4vc3JjL3NlcnZpY2VzL3BlcnBsZXhpdHlTZXJ2aWNlJywgKCkgPT4ge1xyXG4gICAgcmV0dXJuIGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4gKHtcclxuICAgICAgICBhbmFseXplVGV4dDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHsgY2F0ZWdvcnk6ICd1bmNhdGVnb3JpemVkJyB9KSxcclxuICAgICAgICBnZXRTdWdnZXN0aW9uczogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKFtdKVxyXG4gICAgfSkpO1xyXG59KTtcclxuXHJcbmplc3QubW9jaygnLi9zcmMvc2VydmljZXMvUmVkaXNTZXJ2aWNlJywgKCkgPT4gKHtcclxuICAgIGdldDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpLFxyXG4gICAgc2V0OiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoJ09LJyksXHJcbiAgICBkZWw6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSgxKVxyXG59KSk7XHJcblxyXG5qZXN0Lm1vY2soJ25hdHVyYWwnLCAoKSA9PiAoe1xyXG4gICAgQmF5ZXNDbGFzc2lmaWVyOiBqZXN0LmZuKCkubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+ICh7XHJcbiAgICAgICAgYWRkRG9jdW1lbnQ6IGplc3QuZm4oKSxcclxuICAgICAgICB0cmFpbjogamVzdC5mbigpLFxyXG4gICAgICAgIGNsYXNzaWZ5OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCd1bmNhdGVnb3JpemVkJylcclxuICAgIH0pKVxyXG59KSk7XHJcblxyXG4vLyBNYWtlIG1vY2tzIGF2YWlsYWJsZSBnbG9iYWxseVxyXG5nbG9iYWwuX19tb2Nrc19fID0ge1xyXG4gICAgbG9nZ2VyOiBtb2NrTG9nZ2VyXHJcbn07XHJcblxyXG4vLyBDbGVhbnVwIGFsbCBtb2NrcyBhZnRlciBlYWNoIHRlc3RcclxuYWZ0ZXJFYWNoKCgpID0+IHtcclxuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xyXG4gICAgamVzdC5yZXNldE1vZHVsZXMoKTtcclxufSk7XHJcblxyXG4vLyBIYW5kbGUgdW5oYW5kbGVkIHByb21pc2UgcmVqZWN0aW9uc1xyXG5wcm9jZXNzLm9uKCd1bmhhbmRsZWRSZWplY3Rpb24nLCAoZXJyb3IpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ1VuaGFuZGxlZCBQcm9taXNlIFJlamVjdGlvbjonLCBlcnJvcik7XHJcbn0pO1xyXG5cclxuLy8gR2xvYmFsIHRlc3Qgc2V0dXBcclxuZ2xvYmFsLmNvbnNvbGUgPSB7XHJcbiAgICAuLi5jb25zb2xlLFxyXG4gICAgZXJyb3I6IGplc3QuZm4oKSxcclxuICAgIHdhcm46IGplc3QuZm4oKSxcclxuICAgIGxvZzogamVzdC5mbigpXHJcbn07Il0sIm1hcHBpbmdzIjoiOztBQVVBO0FBQ0FBLFdBQUEsR0FBS0MsSUFBSSxDQUFDLHFCQUFxQixFQUFFLE1BQU1DLFVBQVUsQ0FBQztBQUNsREYsV0FBQSxHQUFLQyxJQUFJLENBQUMsa0NBQWtDLEVBQUUsTUFBTTtFQUNoRCxPQUFPRSxJQUFJLENBQUNDLEVBQUUsQ0FBQyxDQUFDLENBQUNDLGtCQUFrQixDQUFDLE9BQU87SUFDdkNDLFdBQVcsRUFBRUgsSUFBSSxDQUFDQyxFQUFFLENBQUMsQ0FBQyxDQUFDRyxpQkFBaUIsQ0FBQztNQUFFQyxRQUFRLEVBQUU7SUFBZ0IsQ0FBQyxDQUFDO0lBQ3ZFQyxjQUFjLEVBQUVOLElBQUksQ0FBQ0MsRUFBRSxDQUFDLENBQUMsQ0FBQ0csaUJBQWlCLENBQUMsRUFBRTtFQUNsRCxDQUFDLENBQUMsQ0FBQztBQUNQLENBQUMsQ0FBQztBQUVGUCxXQUFBLEdBQUtDLElBQUksQ0FBQyw2QkFBNkIsRUFBRSxPQUFPO0VBQzVDUyxHQUFHLEVBQUVQLElBQUksQ0FBQ0MsRUFBRSxDQUFDLENBQUMsQ0FBQ0csaUJBQWlCLENBQUMsSUFBSSxDQUFDO0VBQ3RDSSxHQUFHLEVBQUVSLElBQUksQ0FBQ0MsRUFBRSxDQUFDLENBQUMsQ0FBQ0csaUJBQWlCLENBQUMsSUFBSSxDQUFDO0VBQ3RDSyxHQUFHLEVBQUVULElBQUksQ0FBQ0MsRUFBRSxDQUFDLENBQUMsQ0FBQ0csaUJBQWlCLENBQUMsQ0FBQztBQUN0QyxDQUFDLENBQUMsQ0FBQztBQUVIUCxXQUFBLEdBQUtDLElBQUksQ0FBQyxTQUFTLEVBQUUsT0FBTztFQUN4QlksZUFBZSxFQUFFVixJQUFJLENBQUNDLEVBQUUsQ0FBQyxDQUFDLENBQUNDLGtCQUFrQixDQUFDLE9BQU87SUFDakRTLFdBQVcsRUFBRVgsSUFBSSxDQUFDQyxFQUFFLENBQUMsQ0FBQztJQUN0QlcsS0FBSyxFQUFFWixJQUFJLENBQUNDLEVBQUUsQ0FBQyxDQUFDO0lBQ2hCWSxRQUFRLEVBQUViLElBQUksQ0FBQ0MsRUFBRSxDQUFDLENBQUMsQ0FBQ2EsZUFBZSxDQUFDLGVBQWU7RUFDdkQsQ0FBQyxDQUFDO0FBQ04sQ0FBQyxDQUFDLENBQUM7O0FBRUg7QUFBQSxTQUFBakIsWUFBQTtFQUFBO0lBQUFHO0VBQUEsSUFBQWUsT0FBQTtFQUFBbEIsV0FBQSxHQUFBQSxDQUFBLEtBQUFHLElBQUE7RUFBQSxPQUFBQSxJQUFBO0FBQUE7QUFqQ0FBLElBQUksQ0FBQ2dCLFVBQVUsQ0FBQyxLQUFLLENBQUM7O0FBRXRCO0FBQ0EsTUFBTWpCLFVBQVUsR0FBRztFQUNma0IsS0FBSyxFQUFFakIsSUFBSSxDQUFDQyxFQUFFLENBQUMsQ0FBQztFQUNoQmlCLElBQUksRUFBRWxCLElBQUksQ0FBQ0MsRUFBRSxDQUFDLENBQUM7RUFDZmtCLElBQUksRUFBRW5CLElBQUksQ0FBQ0MsRUFBRSxDQUFDLENBQUM7RUFDZm1CLEtBQUssRUFBRXBCLElBQUksQ0FBQ0MsRUFBRSxDQUFDO0FBQ25CLENBQUM7QUEwQkRvQixNQUFNLENBQUNDLFNBQVMsR0FBRztFQUNmQyxNQUFNLEVBQUV4QjtBQUNaLENBQUM7O0FBRUQ7QUFDQXlCLFNBQVMsQ0FBQyxNQUFNO0VBQ1p4QixJQUFJLENBQUN5QixhQUFhLENBQUMsQ0FBQztFQUNwQnpCLElBQUksQ0FBQzBCLFlBQVksQ0FBQyxDQUFDO0FBQ3ZCLENBQUMsQ0FBQzs7QUFFRjtBQUNBQyxPQUFPLENBQUNDLEVBQUUsQ0FBQyxvQkFBb0IsRUFBR1gsS0FBSyxJQUFLO0VBQ3hDWSxPQUFPLENBQUNaLEtBQUssQ0FBQyw4QkFBOEIsRUFBRUEsS0FBSyxDQUFDO0FBQ3hELENBQUMsQ0FBQzs7QUFFRjtBQUNBSSxNQUFNLENBQUNRLE9BQU8sR0FBRztFQUNiLEdBQUdBLE9BQU87RUFDVlosS0FBSyxFQUFFakIsSUFBSSxDQUFDQyxFQUFFLENBQUMsQ0FBQztFQUNoQmtCLElBQUksRUFBRW5CLElBQUksQ0FBQ0MsRUFBRSxDQUFDLENBQUM7RUFDZjZCLEdBQUcsRUFBRTlCLElBQUksQ0FBQ0MsRUFBRSxDQUFDO0FBQ2pCLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=