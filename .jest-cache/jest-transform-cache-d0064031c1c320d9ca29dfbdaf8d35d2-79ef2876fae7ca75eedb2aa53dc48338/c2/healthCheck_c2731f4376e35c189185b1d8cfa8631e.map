{"version":3,"names":["Redis","require","logger","HealthCheck","constructor","redisClient","host","process","env","REDIS_HOST","port","REDIS_PORT","password","REDIS_PASSWORD","check","startTime","Date","now","ping","latency","status","redis","error","message","middleware","req","res","health","statusCode","json","module","exports"],"sources":["healthCheck.js"],"sourcesContent":["const Redis = require('ioredis');\r\nconst logger = require('../config/logger');\r\n\r\nclass HealthCheck {\r\n    constructor() {\r\n        this.redisClient = new Redis({\r\n            host: process.env.REDIS_HOST,\r\n            port: process.env.REDIS_PORT,\r\n            password: process.env.REDIS_PASSWORD\r\n        });\r\n    }\r\n\r\n    async check() {\r\n        try {\r\n            const startTime = Date.now();\r\n            await this.redisClient.ping();\r\n            const latency = Date.now() - startTime;\r\n\r\n            return {\r\n                status: 'healthy',\r\n                redis: {\r\n                    status: 'up',\r\n                    latency: `${latency}ms`\r\n                }\r\n            };\r\n        } catch (error) {\r\n            logger.error('Redis health check failed:', error);\r\n            return {\r\n                status: 'unhealthy',\r\n                redis: {\r\n                    status: 'down',\r\n                    error: error.message\r\n                }\r\n            };\r\n        }\r\n    }\r\n\r\n    middleware() {\r\n        return async (req, res) => {\r\n            const health = await this.check();\r\n            const statusCode = health.status === 'healthy' ? 200 : 503;\r\n            res.status(statusCode).json(health);\r\n        };\r\n    }\r\n}\r\n\r\nmodule.exports = new HealthCheck();"],"mappings":";;AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAC,SAAS,CAAC;AAChC,MAAMC,MAAM,GAAGD,OAAO,CAAC,kBAAkB,CAAC;AAE1C,MAAME,WAAW,CAAC;EACdC,WAAWA,CAAA,EAAG;IACV,IAAI,CAACC,WAAW,GAAG,IAAIL,KAAK,CAAC;MACzBM,IAAI,EAAEC,OAAO,CAACC,GAAG,CAACC,UAAU;MAC5BC,IAAI,EAAEH,OAAO,CAACC,GAAG,CAACG,UAAU;MAC5BC,QAAQ,EAAEL,OAAO,CAACC,GAAG,CAACK;IAC1B,CAAC,CAAC;EACN;EAEA,MAAMC,KAAKA,CAAA,EAAG;IACV,IAAI;MACA,MAAMC,SAAS,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC;MAC5B,MAAM,IAAI,CAACZ,WAAW,CAACa,IAAI,CAAC,CAAC;MAC7B,MAAMC,OAAO,GAAGH,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGF,SAAS;MAEtC,OAAO;QACHK,MAAM,EAAE,SAAS;QACjBC,KAAK,EAAE;UACHD,MAAM,EAAE,IAAI;UACZD,OAAO,EAAE,GAAGA,OAAO;QACvB;MACJ,CAAC;IACL,CAAC,CAAC,OAAOG,KAAK,EAAE;MACZpB,MAAM,CAACoB,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;MACjD,OAAO;QACHF,MAAM,EAAE,WAAW;QACnBC,KAAK,EAAE;UACHD,MAAM,EAAE,MAAM;UACdE,KAAK,EAAEA,KAAK,CAACC;QACjB;MACJ,CAAC;IACL;EACJ;EAEAC,UAAUA,CAAA,EAAG;IACT,OAAO,OAAOC,GAAG,EAAEC,GAAG,KAAK;MACvB,MAAMC,MAAM,GAAG,MAAM,IAAI,CAACb,KAAK,CAAC,CAAC;MACjC,MAAMc,UAAU,GAAGD,MAAM,CAACP,MAAM,KAAK,SAAS,GAAG,GAAG,GAAG,GAAG;MAC1DM,GAAG,CAACN,MAAM,CAACQ,UAAU,CAAC,CAACC,IAAI,CAACF,MAAM,CAAC;IACvC,CAAC;EACL;AACJ;AAEAG,MAAM,CAACC,OAAO,GAAG,IAAI5B,WAAW,CAAC,CAAC","ignoreList":[]}