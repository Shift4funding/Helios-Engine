{"version":3,"names":["CircuitBreaker","require","logger","defaultOptions","timeout","errorThresholdPercentage","resetTimeout","CircuitBreakerService","create","fn","options","breaker","fallback","success","error","on","info","warn","module","exports"],"sources":["circuitBreakerService.js"],"sourcesContent":["const CircuitBreaker = require('opossum');\r\nconst logger = require('../config/logger');\r\n\r\nconst defaultOptions = {\r\n    timeout: 3000,\r\n    errorThresholdPercentage: 50,\r\n    resetTimeout: 30000\r\n};\r\n\r\nclass CircuitBreakerService {\r\n    create(fn, options = {}) {\r\n        const breaker = new CircuitBreaker(fn, {\r\n            ...defaultOptions,\r\n            ...options\r\n        });\r\n\r\n        breaker.fallback(() => ({\r\n            success: false,\r\n            error: 'Service temporarily unavailable'\r\n        }));\r\n\r\n        breaker.on('success', () => {\r\n            logger.info('Circuit Breaker: Success');\r\n        });\r\n\r\n        breaker.on('failure', () => {\r\n            logger.warn('Circuit Breaker: Failure');\r\n        });\r\n\r\n        return breaker;\r\n    }\r\n}\r\n\r\nmodule.exports = new CircuitBreakerService();"],"mappings":";;AAAA,MAAMA,cAAc,GAAGC,OAAO,CAAC,SAAS,CAAC;AACzC,MAAMC,MAAM,GAAGD,OAAO,CAAC,kBAAkB,CAAC;AAE1C,MAAME,cAAc,GAAG;EACnBC,OAAO,EAAE,IAAI;EACbC,wBAAwB,EAAE,EAAE;EAC5BC,YAAY,EAAE;AAClB,CAAC;AAED,MAAMC,qBAAqB,CAAC;EACxBC,MAAMA,CAACC,EAAE,EAAEC,OAAO,GAAG,CAAC,CAAC,EAAE;IACrB,MAAMC,OAAO,GAAG,IAAIX,cAAc,CAACS,EAAE,EAAE;MACnC,GAAGN,cAAc;MACjB,GAAGO;IACP,CAAC,CAAC;IAEFC,OAAO,CAACC,QAAQ,CAAC,OAAO;MACpBC,OAAO,EAAE,KAAK;MACdC,KAAK,EAAE;IACX,CAAC,CAAC,CAAC;IAEHH,OAAO,CAACI,EAAE,CAAC,SAAS,EAAE,MAAM;MACxBb,MAAM,CAACc,IAAI,CAAC,0BAA0B,CAAC;IAC3C,CAAC,CAAC;IAEFL,OAAO,CAACI,EAAE,CAAC,SAAS,EAAE,MAAM;MACxBb,MAAM,CAACe,IAAI,CAAC,0BAA0B,CAAC;IAC3C,CAAC,CAAC;IAEF,OAAON,OAAO;EAClB;AACJ;AAEAO,MAAM,CAACC,OAAO,GAAG,IAAIZ,qBAAqB,CAAC,CAAC","ignoreList":[]}